<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Particles · Mera.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Mera.jl logo"/></a><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../00_multi_FirstSteps/">First Steps</a></li><li><span class="tocitem">1-Data Inspection</span><ul><li><a class="tocitem" href="../01_hydro_First_Inspection/">Hydro</a></li><li class="is-active"><a class="tocitem" href>Particles</a><ul class="internal"><li><a class="tocitem" href="#Simulation-Overview"><span>Simulation Overview</span></a></li><li><a class="tocitem" href="#Load-AMR/Particle-Data"><span>Load AMR/Particle Data</span></a></li><li><a class="tocitem" href="#Overview-of-AMR/Particles"><span>Overview of AMR/Particles</span></a></li><li><a class="tocitem" href="#Data-inspection"><span>Data inspection</span></a></li></ul></li><li><a class="tocitem" href="../01_clumps_First_Inspection/">Clumps</a></li></ul></li><li><span class="tocitem">2-Load by Selection</span><ul><li><a class="tocitem" href="../02_hydro_Load_Selections/">Hydro</a></li><li><a class="tocitem" href="../02_particles_Load_Selections/">Particles</a></li><li><a class="tocitem" href="../02_clumps_Load_Selections/">Clumps</a></li></ul></li><li><span class="tocitem">3-Get Subregions</span><ul><li><a class="tocitem" href="../03_hydro_Get_Subregions/03_hydro_Get_Subregions/">Hydro</a></li><li><a class="tocitem" href="../03_particles_Get_Subregions/03_particles_Get_Subregions/">Particles</a></li><li><a class="tocitem" href="../03_clumps_Get_Subregions/03_clumps_Get_Subregions/">Clumps</a></li></ul></li><li><a class="tocitem" href="../04_multi_Basic_Calculations/">4-Basic Calculations</a></li><li><a class="tocitem" href="../05_multi_Masking_Filtering/05_multi_Masking_Filtering/">5-Mask/Filter/Meta</a></li><li><span class="tocitem">6-Projection</span><ul><li><a class="tocitem" href="../06_hydro_Projection/06_hydro_Projection/">Hydro</a></li><li><a class="tocitem" href="../06_particles_Projection/06_particles_Projection/">Particles</a></li></ul></li><li><a class="tocitem" href="../07_multi_Mera_Files/">7-MERA-Files</a></li><li><a class="tocitem" href="../Miscellaneous/">8-Miscellaneous</a></li><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../api/">API Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">1-Data Inspection</a></li><li class="is-active"><a href>Particles</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Particles</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ManuelBehrendt/Mera.jl/blob/master/docs/src/01_particles_First_Inspection.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id=".-Particles:-First-Data-Inspection"><a class="docs-heading-anchor" href="#.-Particles:-First-Data-Inspection">1. Particles: First Data Inspection</a><a id=".-Particles:-First-Data-Inspection-1"></a><a class="docs-heading-anchor-permalink" href="#.-Particles:-First-Data-Inspection" title="Permalink"></a></h1><h2 id="Simulation-Overview"><a class="docs-heading-anchor" href="#Simulation-Overview">Simulation Overview</a><a id="Simulation-Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Simulation-Overview" title="Permalink"></a></h2><pre><code class="language-julia hljs">using Mera
info = getinfo(300, &quot;../../testing/simulations/mw_L10&quot;);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2023-04-10T10:58:43.590

Code: RAMSES
output [300] summary:
mtime: 2023-04-09T05:34:09
ctime: 2023-04-10T08:08:14.488
=======================================================
simulation time: 445.89 [Myr]
boxlen: 48.0 [kpc]
ncpu: 640
ndim: 3
-------------------------------------------------------
amr:           true
level(s): 6 - 10 --&gt; cellsize(s): 750.0 [pc] - 46.88 [pc]
-------------------------------------------------------
hydro:         true
hydro-variables:  7  --&gt; (:rho, :vx, :vy, :vz, :p, :var6, :var7)
hydro-descriptor: (:density, :velocity_x, :velocity_y, :velocity_z, :pressure, :scalar_00, :scalar_01)
γ: 1.6667
-------------------------------------------------------
gravity:       true
gravity-variables: (:epot, :ax, :ay, :az)
-------------------------------------------------------
particles:     true
- Nstars:   5.445150e+05 
particle-variables: 7  --&gt; (:vx, :vy, :vz, :mass, :family, :tag, :birth)
particle-descriptor: (:position_x, :position_y, :position_z, :velocity_x, :velocity_y, :velocity_z, :mass, :identity, :levelp, :family, :tag, :birth_time)
-------------------------------------------------------
rt:            false
clumps:           false
-------------------------------------------------------
namelist-file: (&quot;&amp;COOLING_PARAMS&quot;, &quot;&amp;SF_PARAMS&quot;, &quot;&amp;AMR_PARAMS&quot;, &quot;&amp;BOUNDARY_PARAMS&quot;, &quot;&amp;OUTPUT_PARAMS&quot;, &quot;&amp;POISSON_PARAMS&quot;, &quot;&amp;RUN_PARAMS&quot;, &quot;&amp;FEEDBACK_PARAMS&quot;, &quot;&amp;HYDRO_PARAMS&quot;, &quot;&amp;INIT_PARAMS&quot;, &quot;&amp;REFINE_PARAMS&quot;)
-------------------------------------------------------
timer-file:       true
compilation-file: false
makefile:         true
patchfile:        true
=======================================================</code></pre><p>A short overview of the loaded particle properties is printed:</p><ul><li>existence of particle files</li><li>the predefined variables</li><li>the number of particles for each id/family (if exist)</li><li>the variable names from the descriptor file (if exist)</li></ul><p>The functions in <strong>Mera</strong> &quot;know&quot; the predefined particle variable names: </p><ul><li>From &gt;= ramses-version-2018: :vx, :vy, :vz, :mass, :family, :tag, :birth, :metals :var9,.... </li><li>For  =&lt; ramses-version-2017: :vx, :vy, :vz, :mass, :birth, :var6, :var7,.... </li><li>Currently, the following variables are loaded by default (if exist): :level, :x, :y, :z, :id, :family, :tag.</li><li>The cpu number associated with the particles can be loaded with the variable names: :cpu or :varn1</li><li>In a future version the variable names from the particle descriptor can be used by setting the field info.descriptor.useparticles = true . </li></ul><p>Get an overview of the loaded particle properties:</p><pre><code class="language-julia hljs">viewfields(info.part_info)</code></pre><pre><code class="nohighlight hljs">[Mera]: Particle overview
===============================
eta_sn	= 0.0
age_sn	= 0.6706464407596582
f_w	= 0.0
Npart	= 0
Ndm	= 0
Nstars	= 544515
Nsinks	= 0
Ncloud	= 0
Ndebris	= 0
Nother	= 0
Nundefined	= 0
other_tracer1	= 0
debris_tracer	= 0
cloud_tracer	= 0
star_tracer	= 0
other_tracer2	= 0
gas_tracer	= 0</code></pre><h2 id="Load-AMR/Particle-Data"><a class="docs-heading-anchor" href="#Load-AMR/Particle-Data">Load AMR/Particle Data</a><a id="Load-AMR/Particle-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Load-AMR/Particle-Data" title="Permalink"></a></h2><p>Read the AMR and the Particle data from all files of the full box with all existing variables and particle positions:</p><pre><code class="language-julia hljs">particles = getparticles(info);</code></pre><pre><code class="nohighlight hljs">[Mera]: Get particle data: 2023-04-10T10:58:56.439

Key vars=(:level, :x, :y, :z, :id, :family, :tag)
Using var(s)=(1, 2, 3, 4, 7) = (:vx, :vy, :vz, :mass, :birth) 

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]



[32mProgress: 100%|█████████████████████████████████████████| Time: 0:00:02[39m


Found 5.445150e+05 particles
Memory used for data table :38.42913246154785 MB
-------------------------------------------------------</code></pre><p>The memory consumption of the data table is printed at the end. We provide a function which gives the possibility to print the used memory of any object: </p><pre><code class="language-julia hljs">usedmemory(particles);</code></pre><pre><code class="nohighlight hljs">Memory used: 38.451 MB</code></pre><p>The assigned object is now of type <code>PartDataType</code>:</p><pre><code class="language-julia hljs">typeof(particles)</code></pre><pre><code class="nohighlight hljs">PartDataType</code></pre><p>It is a sub-type of ContainMassDataSetType</p><pre><code class="language-julia hljs">supertype( ContainMassDataSetType )</code></pre><pre><code class="nohighlight hljs">DataSetType</code></pre><p>ContainMassDataSetType is a sub-type of to the super-type DataSetType</p><pre><code class="language-julia hljs">supertype( PartDataType )</code></pre><pre><code class="nohighlight hljs">HydroPartType</code></pre><p>The data is stored in a <strong>JuliaDB</strong> table and the user selected particle variables and parameters are assigned to fields:</p><pre><code class="language-julia hljs">viewfields(particles)</code></pre><pre><code class="nohighlight hljs">data ==&gt; JuliaDB table: (:level, :x, :y, :z, :id, :family, :tag, :vx, :vy, :vz, :mass, :birth)

info ==&gt; subfields: (:output, :path, :fnames, :simcode, :mtime, :ctime, :ncpu, :ndim, :levelmin, :levelmax, :boxlen, :time, :aexp, :H0, :omega_m, :omega_l, :omega_k, :omega_b, :unit_l, :unit_d, :unit_m, :unit_v, :unit_t, :gamma, :hydro, :nvarh, :nvarp, :nvarrt, :variable_list, :gravity_variable_list, :particles_variable_list, :rt_variable_list, :clumps_variable_list, :sinks_variable_list, :descriptor, :amr, :gravity, :particles, :rt, :clumps, :sinks, :namelist, :namelist_content, :headerfile, :makefile, :files_content, :timerfile, :compilationfile, :patchfile, :Narraysize, :scale, :grid_info, :part_info, :compilation, :constants)

lmin	= 6
lmax	= 10
boxlen	= 48.0
ranges	= [0.0, 1.0, 0.0, 1.0, 0.0, 1.0]
selected_partvars	= [:level, :x, :y, :z, :id, :family, :tag, :vx, :vy, :vz, :mass, :birth]

scale ==&gt; subfields: (:Mpc, :kpc, :pc, :mpc, :ly, :Au, :km, :m, :cm, :mm, :μm, :Mpc3, :kpc3, :pc3, :mpc3, :ly3, :Au3, :km3, :m3, :cm3, :mm3, :μm3, :Msol_pc3, :Msun_pc3, :g_cm3, :Msol_pc2, :Msun_pc2, :g_cm2, :Gyr, :Myr, :yr, :s, :ms, :Msol, :Msun, :Mearth, :Mjupiter, :g, :km_s, :m_s, :cm_s, :nH, :erg, :g_cms2, :T_mu, :K_mu, :T, :K, :Ba, :g_cm_s2, :p_kB, :K_cm3)</code></pre><p>For convenience, all the fields from the info-object above (InfoType) are now also accessible from the object with &quot;particles.info&quot; and the scaling relations from code to cgs units in &quot;particles.scale&quot;.</p><p>Print the fields of an object (composite type) in a simple list:</p><pre><code class="language-julia hljs">propertynames(particles)</code></pre><pre><code class="nohighlight hljs">(:data, :info, :lmin, :lmax, :boxlen, :ranges, :selected_partvars, :used_descriptors, :scale)</code></pre><h2 id="Overview-of-AMR/Particles"><a class="docs-heading-anchor" href="#Overview-of-AMR/Particles">Overview of AMR/Particles</a><a id="Overview-of-AMR/Particles-1"></a><a class="docs-heading-anchor-permalink" href="#Overview-of-AMR/Particles" title="Permalink"></a></h2><p>Get an overview of the AMR structure associated with the object <code>particles</code> (PartDataType). The printed information is stored into the object <code>overview_amr</code> as a <strong>JuliaDB</strong> table (code units)  and can be used for further calculations:</p><pre><code class="language-julia hljs">amr_overview = amroverview(particles)</code></pre><pre><code class="nohighlight hljs">Counting...





Table with 5 rows, 2 columns:
level  particles
────────────────
6      1389
7      543126
8      0
9      0
10     0</code></pre><p>Get some overview of the data that is associated with the object <code>particles</code>. The calculated information can be accessed from the object <code>data_overview</code> (here) in code units for further calculations:</p><pre><code class="language-julia hljs">data_overview = dataoverview(particles)</code></pre><pre><code class="nohighlight hljs">Calculating...





Table with 5 rows, 23 columns:
Columns:
#   colname     type
────────────────────
1   level       Any
2   x_min       Any
3   x_max       Any
4   y_min       Any
5   y_max       Any
6   z_min       Any
7   z_max       Any
8   id_min      Any
9   id_max      Any
10  family_min  Any
11  family_max  Any
12  tag_min     Any
13  tag_max     Any
14  vx_min      Any
15  vx_max      Any
16  vy_min      Any
17  vy_max      Any
18  vz_min      Any
19  vz_max      Any
20  mass_min    Any
21  mass_max    Any
22  birth_min   Any
23  birth_max   Any</code></pre><p>If the number of columns is relatively long, the table is typically represented by an overview. To access certain columns, use the <code>select</code> function. The representation &quot;:birth_max&quot; is called a quoted Symbol (<a href="https://docs.julialang.org/en/v1/manual/metaprogramming/#Symbols-1">see in Julia documentation</a>):</p><pre><code class="language-julia hljs">using JuliaDB</code></pre><pre><code class="language-julia hljs">select(data_overview, (:level,:mass_min, :mass_max, :birth_min, :birth_max ) )</code></pre><pre><code class="nohighlight hljs">Table with 5 rows, 5 columns:
level  mass_min    mass_max    birth_min  birth_max
───────────────────────────────────────────────────
6      0.0         0.0         0.0        0.0
7      0.0         0.0         0.0        0.0
8      0.0         0.0         0.0        0.0
9      8.00221e-7  8.00221e-7  5.56525    22.126
10     8.00221e-7  2.00055e-6  0.0951753  29.9032</code></pre><p>Get an array from the column &quot;:birth&quot; in <code>data_overview</code> and scale it to the units <code>Myr</code>. The order of the calculated data is consistent with the table above:</p><pre><code class="language-julia hljs">column(data_overview, :birth_min) * info.scale.Myr </code></pre><pre><code class="nohighlight hljs">5-element Vector{Float64}:
  0.0
  0.0
  0.0
 82.98342559299353
  1.419158337486011</code></pre><p>Or simply convert the <code>birth_max</code> data in the table to <code>Myr</code> units by manipulating the column:</p><pre><code class="language-julia hljs">data_overview = transform(data_overview, :birth_max =&gt; :birth_max =&gt; value-&gt;value * info.scale.Myr);</code></pre><pre><code class="language-julia hljs">select(data_overview, (:level,:mass_min, :mass_max, :birth_min, :birth_max ) )</code></pre><pre><code class="nohighlight hljs">Table with 5 rows, 5 columns:
level  mass_min    mass_max    birth_min  birth_max
───────────────────────────────────────────────────
6      0.0         0.0         0.0        0.0
7      0.0         0.0         0.0        0.0
8      0.0         0.0         0.0        0.0
9      8.00221e-7  8.00221e-7  5.56525    329.92
10     8.00221e-7  2.00055e-6  0.0951753  445.886</code></pre><h2 id="Data-inspection"><a class="docs-heading-anchor" href="#Data-inspection">Data inspection</a><a id="Data-inspection-1"></a><a class="docs-heading-anchor-permalink" href="#Data-inspection" title="Permalink"></a></h2><p>The data is associated with the field <code>particles.data</code> as a <strong>JuliaDB</strong> table (code units).  Each row corresponds to a particle and each column to a property which makes it easy to find, filter, map, aggregate, group the data, etc. More information can be found in the <strong>Mera</strong> tutorials or in: <a href="http://juliadb.org/latest/api/">JuliaDB API Reference</a></p><h3 id="Table-View"><a class="docs-heading-anchor" href="#Table-View">Table View</a><a id="Table-View-1"></a><a class="docs-heading-anchor-permalink" href="#Table-View" title="Permalink"></a></h3><p>The particle positions x,y,z are given in code units and used in many functions of <strong>MERA</strong> and should not be modified.</p><pre><code class="language-julia hljs">particles.data</code></pre><pre><code class="nohighlight hljs">Table with 544515 rows, 12 columns:
Columns:
#   colname  type
────────────────────
1   level    Int32
2   x        Float64
3   y        Float64
4   z        Float64
5   id       Int32
6   family   Int8
7   tag      Int8
8   vx       Float64
9   vy       Float64
10  vz       Float64
11  mass     Float64
12  birth    Float64</code></pre><p>A more detailed view into the data:</p><pre><code class="language-julia hljs">select(particles.data, (:level,:x, :y, :z, :birth) )</code></pre><pre><code class="nohighlight hljs">Table with 544515 rows, 5 columns:
level  x        y        z        birth
─────────────────────────────────────────
9      9.17918  22.4404  24.0107  8.86726
9      9.23642  21.5559  24.0144  8.71495
9      9.35638  20.7472  24.0475  7.91459
9      9.39529  21.1854  24.0155  7.85302
9      9.42686  20.9697  24.0162  8.2184
9      9.42691  22.2181  24.0137  8.6199
9      9.48834  22.0913  24.0137  8.70493
9      9.5262   20.652   24.0179  7.96008
9      9.60376  21.2814  24.0155  8.03346
9      9.6162   20.6243  24.0506  8.56482
9      9.62155  20.6248  24.0173  7.78062
9      9.62252  24.4396  24.0206  9.44825
⋮
10     37.7913  25.6793  24.018   9.78881
10     37.8255  22.6271  24.0279  9.89052
10     37.8451  22.7506  24.027   9.61716
10     37.8799  25.5668  24.0193  10.2294
10     37.969   23.2135  24.0273  9.85439
10     37.9754  22.6288  24.0265  9.4959
10     37.9811  23.2854  24.0283  9.9782
10     37.9919  22.873   24.0271  9.12003
10     37.9966  23.092   24.0281  9.45574
10     38.0328  22.8404  24.0265  9.77493
10     38.0953  22.8757  24.0231  9.20251</code></pre><pre><code class="language-julia hljs"></code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../01_hydro_First_Inspection/">« Hydro</a><a class="docs-footer-nextpage" href="../01_clumps_First_Inspection/">Clumps »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Thursday 11 May 2023 11:09">Thursday 11 May 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
