<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Particles · Mera.jl</title><meta name="title" content="Particles · Mera.jl"/><meta property="og:title" content="Particles · Mera.jl"/><meta property="twitter:title" content="Particles · Mera.jl"/><meta name="description" content="Documentation for Mera.jl."/><meta property="og:description" content="Documentation for Mera.jl."/><meta property="twitter:description" content="Documentation for Mera.jl."/><meta property="og:url" content="https://manuelbehrendt.github.io/Mera.jl/06_particles_Projection/"/><meta property="twitter:url" content="https://manuelbehrendt.github.io/Mera.jl/06_particles_Projection/"/><link rel="canonical" href="https://manuelbehrendt.github.io/Mera.jl/06_particles_Projection/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../assets/custom.js"></script><script src="../assets/music_player.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Mera.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../00_multi_FirstSteps/">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Core Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Data Inspection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01_hydro_First_Inspection/">Hydro</a></li><li><a class="tocitem" href="../01_particles_First_Inspection/">Particles</a></li><li><a class="tocitem" href="../01_clumps_First_Inspection/">Clumps</a></li><li><a class="tocitem" href="../api/data_inspection/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Load by Selection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../02_hydro_Load_Selections/">Hydro</a></li><li><a class="tocitem" href="../02_particles_Load_Selections/">Particles</a></li><li><a class="tocitem" href="../02_clumps_Load_Selections/">Clumps</a></li><li><a class="tocitem" href="../api/data_loading/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Get Subregions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../03_hydro_Get_Subregions/">Hydro</a></li><li><a class="tocitem" href="../03_particles_Get_Subregions/">Particles</a></li><li><a class="tocitem" href="../03_clumps_Get_Subregions/">Clumps</a></li><li><a class="tocitem" href="../api/subregions/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Analysis &amp; Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../04_multi_Basic_Calculations/">Tutorial</a></li><li><a class="tocitem" href="../api/calculations/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Mask/Filter/Meta</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../05_multi_Masking_Filtering/">Tutorial</a></li><li><a class="tocitem" href="../api/masking_filtering/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Projection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../06_hydro_Projection/">Hydro</a></li><li class="is-active"><a class="tocitem" href>Particles</a><ul class="internal"><li><a class="tocitem" href="#Quick-Reference"><span>Quick Reference</span></a></li><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Key-Concepts"><span>Key Concepts</span></a></li><li><a class="tocitem" href="#Environment-Setup-and-Data-Loading"><span>Environment Setup and Data Loading</span></a></li><li><a class="tocitem" href="#Projection-of-Predefined-Quantities"><span>Projection of Predefined Quantities</span></a></li><li><a class="tocitem" href="#Projection-of-a-Single-Quantity-in-Different-Directions-(z,y,x)"><span>Projection of a Single Quantity in Different Directions (z,y,x)</span></a></li><li><a class="tocitem" href="#Function-Output"><span>Function Output</span></a></li><li><a class="tocitem" href="#Plot-Maps-with-PyPlot"><span>Plot Maps with PyPlot</span></a></li><li><a class="tocitem" href="#Projections-of-Derived-Kinematic-Data"><span>Projections of Derived Kinematic Data</span></a></li><li><a class="tocitem" href="#Project-on-a-Coarser-Grid"><span>Project on a Coarser Grid</span></a></li><li><a class="tocitem" href="#Projection-of-the-Birth/Age-Time"><span>Projection of the Birth/Age-Time</span></a></li><li><a class="tocitem" href="#Projection-of-Masked-Data"><span>Projection of Masked Data</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="../api/projections/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Data &amp; Visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">MERA-Files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../07_multi_Mera_Files/">Mera-Files</a></li><li><a class="tocitem" href="../07_1_multi_Mera_Files_Converter/">Converter</a></li><li><a class="tocitem" href="../api/mera_files/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Volume Rendering</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../paraview/paraview_intro/">Intro</a></li><li><a class="tocitem" href="../paraview/08_hydro_VTK_export/">Hydro</a></li><li><a class="tocitem" href="../paraview/08_particles_VTK_export/">Particles</a></li><li><a class="tocitem" href="../api/volume_rendering/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Advanced Features</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Multi-Threading</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../multi-threading/multi-threading_intro/">Tutorial</a></li><li><a class="tocitem" href="../api/multithreading/">API Reference</a></li></ul></li><li><a class="tocitem" href="../advanced_features/testing_guide/">Testing Framework</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Notifications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../notifications/">Overview</a></li><li><a class="tocitem" href="../notifications/01_quick_start/">Quick Start</a></li><li><a class="tocitem" href="../notifications/02_setup/">Setup Guide</a></li><li><a class="tocitem" href="../notifications/bell/">Bell (Local Audio)</a></li><li><a class="tocitem" href="../notifications/email/">Email</a></li><li><a class="tocitem" href="../notifications/zulip/">Zulip (Team Chat)</a></li><li><a class="tocitem" href="../notifications/zulip_templates/">Zulip Templates</a></li><li><a class="tocitem" href="../notifications/03_attachments/">File Attachments</a></li><li><a class="tocitem" href="../notifications/04_output_capture/">Output Capture</a></li><li><a class="tocitem" href="../notifications/05_advanced/">Advanced Features</a></li><li><a class="tocitem" href="../notifications/06_examples/">Examples</a></li><li><a class="tocitem" href="../notifications/07_troubleshooting/">Troubleshooting</a></li><li><a class="tocitem" href="../api/notifications/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../benchmarks/IO/IOperformance/">Server IO</a></li><li><a class="tocitem" href="../benchmarks/RAMSES_reading/ramses_reading/">Parallel RAMSES-Files Reading</a></li><li><a class="tocitem" href="../benchmarks/JLD2_reading/Mera_files_reading/">Mera-Files Reading</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Julia Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../quickreference/01_getting_started/">Getting Started</a></li><li><a class="tocitem" href="../quickreference/02_migrators/">From Other Languages</a></li><li><a class="tocitem" href="../quickreference/03_packages/">Essential Packages</a></li><li><a class="tocitem" href="../quickreference/04_mera_patterns/">Julia Fundamentals</a></li><li><a class="tocitem" href="../quickreference/05_performance/">Performance &amp; Debugging</a></li><li><a class="tocitem" href="../quickreference/06_resources/">Resources &amp; Community</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Examples &amp; Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../Miscellaneous/">Miscellaneous</a></li><li><a class="tocitem" href="../api/">Complete API Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Analysis &amp; Calculations</a></li><li><a class="is-disabled">Projection</a></li><li class="is-active"><a href>Particles</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Particles</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ManuelBehrendt/Mera.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Particle-Data-Projections"><a class="docs-heading-anchor" href="#Particle-Data-Projections">Particle Data Projections</a><a id="Particle-Data-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Data-Projections" title="Permalink"></a></h1><p>This tutorial demonstrates advanced projection techniques for stellar and dark matter particle data using MERA.jl. Learn how to create 2D projections from N-body simulations, analyze stellar populations, and investigate galactic structure through particle-based analysis.</p><h2 id="Quick-Reference"><a class="docs-heading-anchor" href="#Quick-Reference">Quick Reference</a><a id="Quick-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Reference" title="Permalink"></a></h2><h3 id="Essential-Functions"><a class="docs-heading-anchor" href="#Essential-Functions">Essential Functions</a><a id="Essential-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Essential-Functions" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Basic particle projection
projection(particles, :variable, :unit)

# Multi-quantity projection
projection(particles, [:var1, :var2], units=[:unit1, :unit2])

# Spatial selection
projection(particles, :sd, :Msol_pc2,
          xrange=[-10,10], center=[:boxcenter], range_unit=:kpc)

# Direction control
projection(particles, :sd, :Msol_pc2, direction=:x)  # x, y, z directions

# Resolution control
projection(particles, :sd, :Msol_pc2, lmax=9)       # AMR level
projection(particles, :sd, :Msol_pc2, res=256)      # Effective grid resolution
projection(particles, :sd, :Msol_pc2, pxsize=[100.,:pc])  # Physical pixel size

# Stellar population analysis
projection(particles, :age, :Myr, mask=age_mask)
projection(particles, :birth, :Myr, ref_time=0.)</code></pre><h3 id="Key-Particle-Quantities"><a class="docs-heading-anchor" href="#Key-Particle-Quantities">Key Particle Quantities</a><a id="Key-Particle-Quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Particle-Quantities" title="Permalink"></a></h3><ul><li><strong><code>:sd</code></strong> - Surface density (Σ)</li><li><strong><code>:vx, :vy, :vz</code></strong> - Velocity components</li><li><strong><code>:v</code></strong> - Total velocity magnitude</li><li><strong><code>:σ, :σx, :σy, :σz</code></strong> - Velocity dispersions</li><li><strong><code>:ekin</code></strong> - Kinetic energy</li><li><strong><code>:age</code></strong> - Stellar age (relative to snapshot time)</li><li><strong><code>:birth</code></strong> - Birth time (absolute)</li><li><strong><code>:r_cylinder, :vr_cylinder, :vϕ_cylinder</code></strong> - Cylindrical coordinates</li><li><strong><code>:ϕ, :σr_cylinder, :σϕ_cylinder</code></strong> - Cylindrical kinematic quantities</li></ul><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>MERA.jl provides comprehensive projection capabilities for particle-based simulations:</p><ul><li><strong>Stellar surface density projections</strong> in arbitrary directions</li><li><strong>Kinematic analysis</strong> of stellar and dark matter components</li><li><strong>Stellar population studies</strong> through age and birth time projections</li><li><strong>Multi-component analysis</strong> with customizable units</li><li><strong>Coordinate system transformations</strong> (Cartesian, cylindrical, spherical)</li><li><strong>Advanced masking and filtering</strong> for population selection</li></ul><h2 id="Key-Concepts"><a class="docs-heading-anchor" href="#Key-Concepts">Key Concepts</a><a id="Key-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Concepts" title="Permalink"></a></h2><ul><li><strong>Particle Types</strong>: Stellar particles, dark matter,...</li><li><strong>Population Analysis</strong>: Age-based selection and temporal evolution</li><li><strong>Projection Direction</strong>: Control viewing angle (x, y, z directions)</li><li><strong>Grid Resolution</strong>: Customize output resolution via <code>lmax</code>, <code>res</code>, or <code>pxsize</code></li><li><strong>Weighting Schemes</strong>: Mass-weighted projections, ...</li></ul><h2 id="Environment-Setup-and-Data-Loading"><a class="docs-heading-anchor" href="#Environment-Setup-and-Data-Loading">Environment Setup and Data Loading</a><a id="Environment-Setup-and-Data-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-Setup-and-Data-Loading" title="Permalink"></a></h2><h3 id="Package-Configuration-and-Particle-Data"><a class="docs-heading-anchor" href="#Package-Configuration-and-Particle-Data">Package Configuration and Particle Data</a><a id="Package-Configuration-and-Particle-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Configuration-and-Particle-Data" title="Permalink"></a></h3><p>Load particle data from N-body simulations including stellar particles, dark matter, and other particle types.</p><pre><code class="language-julia hljs">using Mera

# Load simulation metadata
# Replace with your simulation path and output number
info = getinfo(300, &quot;/Volumes/FASTStorage/Simulations/Mera-Tests/mw_L10&quot;)

# Load particle data (stellar particles, dark matter, etc.)
# Includes position, velocity, mass, and stellar population properties
particles = getparticles(info);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:07.552

Code: RAMSES
output [300] summary:
mtime: 2023-04-09T05:34:09
ctime: 2025-06-21T18:31:24.020
=======================================================
simulation time: 445.89 [Myr]
boxlen: 48.0 [kpc]
ncpu: 640
ndim: 3
-------------------------------------------------------
amr:           true
level(s): 6 - 10 --&gt; cellsize(s): 750.0 [pc] - 46.88 [pc]
-------------------------------------------------------
hydro:         true
hydro-variables:  7  --&gt; (:rho, :vx, :vy, :vz, :p, :var6, :var7)
hydro-descriptor: (:density, :velocity_x, :velocity_y, :velocity_z, :pressure, :scalar_00, :scalar_01)
γ: 1.6667
-------------------------------------------------------
gravity:       true
gravity-variables: (:epot, :ax, :ay, :az)
-------------------------------------------------------
particles:     true
- Nstars:   5.445150e+05
particle-variables: 7  --&gt; (:vx, :vy, :vz, :mass, :family, :tag, :birth)
particle-descriptor: (:position_x, :position_y, :position_z, :velocity_x, :velocity_y, :velocity_z, :mass, :identity, :levelp, :family, :tag, :birth_time)
-------------------------------------------------------
rt:            false
clumps:           false
-------------------------------------------------------
namelist-file: (&quot;&amp;COOLING_PARAMS&quot;, &quot;&amp;SF_PARAMS&quot;, &quot;&amp;AMR_PARAMS&quot;, &quot;&amp;BOUNDARY_PARAMS&quot;, &quot;&amp;OUTPUT_PARAMS&quot;, &quot;&amp;POISSON_PARAMS&quot;, &quot;&amp;RUN_PARAMS&quot;, &quot;&amp;FEEDBACK_PARAMS&quot;, &quot;&amp;HYDRO_PARAMS&quot;, &quot;&amp;INIT_PARAMS&quot;, &quot;&amp;REFINE_PARAMS&quot;)
-------------------------------------------------------
timer-file:       true
compilation-file: false
makefile:         true
patchfile:        true
=======================================================

[Mera]: Get particle data: 2025-08-14T15:02:11.138

Using threaded processing with 4 threads
Key vars=(:level, :x, :y, :z, :id, :family, :tag)
Using var(s)=(1, 2, 3, 4, 7) = (:vx, :vy, :vz, :mass, :birth)

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]

Processing 640 CPU files using 4 threads
Mode: Threaded processing
Combining results from 4 thread(s)...
Found 5.445150e+05 particles
Memory used for data table :38.428720474243164 MB
-------------------------------------------------------
</code></pre><pre><code class="language-julia hljs"># Inspect the loaded particle data structure
# Shows available fields
particles.data</code></pre><pre><code class="nohighlight hljs">Table with 544515 rows, 12 columns:
Columns:
#   colname  type
────────────────────
1   level    Int32
2   x        Float64
3   y        Float64
4   z        Float64
5   id       Int32
6   family   Int8
7   tag      Int8
8   vx       Float64
9   vy       Float64
10  vz       Float64
11  mass     Float64
12  birth    Float64</code></pre><h2 id="Projection-of-Predefined-Quantities"><a class="docs-heading-anchor" href="#Projection-of-Predefined-Quantities">Projection of Predefined Quantities</a><a id="Projection-of-Predefined-Quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Projection-of-Predefined-Quantities" title="Permalink"></a></h2><p>See the possible variables:</p><pre><code class="language-julia hljs"># Show all available projection quantities and their descriptions
# Displays particle-specific variables and derived quantities
projection()</code></pre><pre><code class="nohighlight hljs">Predefined vars for projections:
------------------------------------------------
=====================[gas]:=====================
       -all the non derived hydro vars-
:cpu, :level, :rho, :cx, :cy, :cz, :vx, :vy, :vz, :p, var6,...
further possibilities: :rho, :density, :ρ
              -derived hydro vars-
:x, :y, :z
:sd or :Σ or :surfacedensity
:mass, :cellsize, :freefall_time
:cs, :mach, :machx, :machy, :machz, :jeanslength, :jeansnumber
:t, :Temp, :Temperature with p/rho

==================[particles]:==================
        all the non derived  vars:
:cpu, :level, :id, :family, :tag
:x, :y, :z, :vx, :vy, :vz, :mass, :birth, :metal....

              -derived particle vars-
:age

==============[gas or particles]:===============
:v, :ekin
squared =&gt; :vx2, :vy2, :vz2
velocity dispersion =&gt; σx, σy, σz, σ

related to a given center:
---------------------------
:vr_cylinder, vr_sphere (radial components)
:vϕ_cylinder, :vθ
squared =&gt; :vr_cylinder2, :vϕ_cylinder2
velocity dispersion =&gt; σr_cylinder, σϕ_cylinder

2d maps (not projected) =&gt; :r_cylinder, :ϕ

------------------------------------------------
</code></pre><h2 id="Projection-of-a-Single-Quantity-in-Different-Directions-(z,y,x)"><a class="docs-heading-anchor" href="#Projection-of-a-Single-Quantity-in-Different-Directions-(z,y,x)">Projection of a Single Quantity in Different Directions (z,y,x)</a><a id="Projection-of-a-Single-Quantity-in-Different-Directions-(z,y,x)-1"></a><a class="docs-heading-anchor-permalink" href="#Projection-of-a-Single-Quantity-in-Different-Directions-(z,y,x)" title="Permalink"></a></h2><p>Here we project the surface density in the z-direction of the data within a particular vertical range (<code>domain=[0:1]</code>) on a grid corresponding to level=9. Pass any object of ParticleDataType (here: &quot;particles&quot;) to the projection-function and select a variable by a Symbol (here: <code>:sd</code> = <code>:surfacedensity</code> = <code>:Σ</code> in M⊙/pc²).</p><pre><code class="language-julia hljs"># Basic surface density projection in z-direction
# Projects stellar particles onto xy-plane with specified resolution
# Z-direction: projects particles onto xy-plane (face-on view)
# X-direction: projects particles onto yz-plane (edge-on view)
proj_z = projection(particles, :sd, :Msol_pc2, lmax=9, zrange=[0.45,0.55], verbose=false)
proj_x = projection(particles, :sd, :Msol_pc2, lmax=9, direction=:x, zrange=[0.45,0.55], verbose=false);</code></pre><h3 id="Select-a-Range-Related-to-a-Center"><a class="docs-heading-anchor" href="#Select-a-Range-Related-to-a-Center">Select a Range Related to a Center</a><a id="Select-a-Range-Related-to-a-Center-1"></a><a class="docs-heading-anchor-permalink" href="#Select-a-Range-Related-to-a-Center" title="Permalink"></a></h3><p>See also in the documentation for: load data by selection</p><pre><code class="language-julia hljs"># Calculate box center coordinates for spatial selection
cv = (particles.boxlen / 2.) * particles.scale.kpc # provide the box-center in kpc
proj_z = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[cv,cv,cv], range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:22.177

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><p>Use the short notation for the box center <code>:bc</code> or <code>:boxcenter</code> for all dimensions (x,y,z):</p><pre><code class="language-julia hljs"># Use convenient box center notation for spatial selection
proj_z = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:boxcenter], range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:22.707

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><pre><code class="language-julia hljs"># Alternative short notation using :bc
proj_z = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:bc], range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:22.840

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><p>Use the box center notation for individual dimensions, here x,z:</p><pre><code class="language-julia hljs"># Mix explicit coordinates with box center notation
proj_z = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:bc, 24., :bc], range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:23.289

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><h3 id="Get-Multiple-Quantities"><a class="docs-heading-anchor" href="#Get-Multiple-Quantities">Get Multiple Quantities</a><a id="Get-Multiple-Quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Get-Multiple-Quantities" title="Permalink"></a></h3><p>Get several quantities with one function call by passing an array containing the selected variables (at least one entry). The keyword name for the units is now in plural.</p><pre><code class="language-julia hljs"># Project multiple quantities simultaneously
proj1_x = projection(particles, [:sd], units=[:Msol_pc2], lmax=9,
                     direction=:x,
                     xrange=[-10.,10.],
                     yrange=[-10.,10.],
                     zrange=[-2.,2.],
                     center=[24.,24.,24.],
                     range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:23.432

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><p>Pass an array containing several quantities to process and their corresponding units:</p><pre><code class="language-julia hljs"># Project surface density and x-velocity component together
proj1_z = projection(particles, [:sd, :vx], units=[:Msol_pc2, :km_s], lmax=9,
                     direction=:x,
                     xrange=[-10.,10.],
                     yrange=[-10.,10.],
                     zrange=[-2.,2.],
                     center=[24.,24.,24.],
                     range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:23.458

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><p>The function can be called without any keywords by preserving the following order: dataobject, variables, units</p><pre><code class="language-julia hljs"># Simplified syntax without explicit keywords
proj1_z = projection(particles, [:sd, :vx], [:Msol_pc2, :km_s], lmax=9,
                     direction=:x,
                     xrange=[-10.,10.],
                     yrange=[-10.,10.],
                     zrange=[-2.,2.],
                     center=[24.,24.,24.],
                     range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:24.016

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><p>If all selected variables should be of the same unit use the following arguments: dataobject, array of quantities, unit (no array needed)</p><pre><code class="language-julia hljs"># Project multiple velocity components with unified units
projvel_z = projection(particles, [:vx, :vy, :vz], :km_s, lmax=9,
                       xrange=[-10.,10.],
                       yrange=[-10.,10.],
                       zrange=[-2.,2.],
                       center=[24.,24.,24.],
                       range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:24.078

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><h2 id="Function-Output"><a class="docs-heading-anchor" href="#Function-Output">Function Output</a><a id="Function-Output-1"></a><a class="docs-heading-anchor-permalink" href="#Function-Output" title="Permalink"></a></h2><p>List the fields of the assigned object:</p><pre><code class="language-julia hljs"># Examine the structure of projection objects
propertynames(projvel_z)</code></pre><pre><code class="nohighlight hljs">(:maps, :maps_unit, :maps_lmax, :maps_mode, :lmax_projected, :lmin, :lmax, :ref_time, :ranges, :extent, :cextent, :ratio, :effres, :pixsize, :boxlen, :scale, :info)</code></pre><p>The projected 2D maps are stored in a dictionary:</p><pre><code class="language-julia hljs"># Access the maps dictionary containing projection data
projvel_z.maps  # NaN for empty regions</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 4 entries:
  :sd =&gt; [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.0 …
  :vx =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN NaN …
  :vy =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN NaN …
  :vz =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN NaN …</code></pre><p>The maps can be accessed by giving the name of the dictionary:</p><pre><code class="language-julia hljs"># Access individual projection maps by variable name
proj1_z.maps[:sd]</code></pre><pre><code class="nohighlight hljs">214×44 Matrix{Float64}:
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 ⋮                        ⋮              ⋱                 ⋮
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0  …  0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0
 0.0  0.0  0.0  0.0  0.0  0.0  0.0  0.0     0.0  0.0  0.0  0.0  0.0  0.0  0.0</code></pre><p>The units of the maps are stored in:</p><pre><code class="language-julia hljs"># Check units for each projected quantity
projvel_z.maps_unit</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 4 entries:
  :sd =&gt; :standard
  :vx =&gt; :km_s
  :vy =&gt; :km_s
  :vz =&gt; :km_s</code></pre><p>The following fields are helpful for further calculations or plots.</p><pre><code class="language-julia hljs"># Get coordinate ranges normalized to domain [0:1]
projvel_z.ranges</code></pre><pre><code class="nohighlight hljs">6-element Vector{Float64}:
 0.29166666666647767
 0.7083333333328743
 0.29166666666647767
 0.7083333333328743
 0.4583333333330363
 0.5416666666663156</code></pre><pre><code class="language-julia hljs"># Get coordinate ranges in code units
projvel_z.extent</code></pre><pre><code class="nohighlight hljs">4-element Vector{Float64}:
 13.96875
 34.03125
 13.96875
 34.03125</code></pre><pre><code class="language-julia hljs"># Get coordinate ranges relative to center (code units)
projvel_z.cextent</code></pre><pre><code class="nohighlight hljs">4-element Vector{Float64}:
 -10.031250000015554
  10.031249999984446
 -10.031250000015554
  10.031249999984446</code></pre><pre><code class="language-julia hljs"># Get aspect ratio between coordinate ranges
projvel_z.ratio  # the ratio between the two ranges</code></pre><pre><code class="nohighlight hljs">1.0</code></pre><h2 id="Plot-Maps-with-PyPlot"><a class="docs-heading-anchor" href="#Plot-Maps-with-PyPlot">Plot Maps with PyPlot</a><a id="Plot-Maps-with-PyPlot-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-Maps-with-PyPlot" title="Permalink"></a></h2><pre><code class="language-julia hljs">proj_z = projection(particles, :sd, :Msol_pc2, lmax=9,
                    zrange=[-2.,2.], center=[:boxcenter], range_unit=:kpc,
                    verbose=false)
proj_x = projection(particles, :sd, :Msol_pc2, lmax=9,
                    zrange=[-2.,2.], center=[:boxcenter], range_unit=:kpc,
                    verbose=false,
                    direction = :x);</code></pre><p>Python functions can be directly called in Julia, which gives the opportunity, e.g. to use the Matplotlib library.</p><pre><code class="language-julia hljs">using PyPlot
using ColorSchemes
cmap = ColorMap(ColorSchemes.lajolla.colors) # See http://www.fabiocrameri.ch/colourmaps.php
cmap2 = ColorMap(reverse(ColorSchemes.roma.colors))</code></pre><pre><code class="nohighlight hljs">ColorMap &quot;cm_9039267583110145682&quot;</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:sd])), cmap=cmap, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-0.5, vmax=1.5)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:sd])), cmap=cmap, origin=&quot;lower&quot;, extent=proj_x.cextent, vmin=-0.5, vmax=3)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);
tight_layout()</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_41_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><p>Project a specific spatial range and plot the axes of the map relative to the box-center (given by keyword: data_center):</p><pre><code class="language-julia hljs">proj_z = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,0.], yrange=[-10.,0.], zrange=[-2.,2.], center=[:boxcenter], range_unit=:kpc,
                    verbose=false,
                    data_center=[24.,24.,24.], data_center_unit=:kpc)
proj_x = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,0.], yrange=[-10.,0.], zrange=[-2.,2.], center=[:boxcenter], range_unit=:kpc,
                    verbose=false,
                    data_center=[24.,24.,24.], data_center_unit=:kpc,
                    direction = :x);</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:sd])), cmap=cmap, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-0.5, vmax=2.)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:sd])), cmap=cmap, origin=&quot;lower&quot;, extent=proj_x.cextent, vmin=-0.5, vmax=3)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_44_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><p>Plot the axes of the map relative to the map-center (given by keyword: data_center):</p><pre><code class="language-julia hljs">proj_z = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,0.], yrange=[-10.,0.], zrange=[-2.,2.], center=[:boxcenter], range_unit=:kpc,
                    verbose=false,
                    data_center=[19.,19.,24.], data_center_unit=:kpc)
proj_x = projection(particles, :sd, :Msol_pc2, lmax=9,
                    xrange=[-10.,0.], yrange=[-10.,0.], zrange=[-2.,2.], center=[:boxcenter], range_unit=:kpc,
                    verbose=false,
                    data_center=[19.,19.,24.], data_center_unit=:kpc,
                    direction = :x);</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:sd])), cmap=cmap, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-0.5, vmax=2.)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:sd])), cmap=cmap, origin=&quot;lower&quot;, extent=proj_x.cextent, vmin=-0.5, vmax=3)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_47_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><h2 id="Projections-of-Derived-Kinematic-Data"><a class="docs-heading-anchor" href="#Projections-of-Derived-Kinematic-Data">Projections of Derived Kinematic Data</a><a id="Projections-of-Derived-Kinematic-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Projections-of-Derived-Kinematic-Data" title="Permalink"></a></h2><h4 id="Use-quantities-in-cartesian-coordinates:"><a class="docs-heading-anchor" href="#Use-quantities-in-cartesian-coordinates:">Use quantities in cartesian coordinates:</a><a id="Use-quantities-in-cartesian-coordinates:-1"></a><a class="docs-heading-anchor-permalink" href="#Use-quantities-in-cartesian-coordinates:" title="Permalink"></a></h4><p>Project the following derived data (mass weighted by default): The absolute value of the velocity :v, the velocity dispersion :σ in different directions and the kinetic energy :ekin. The Julia language supports Unicode characters and can be inserted by e.g. &quot;\sigma + tab-key&quot; leading to: <strong>σ</strong>.</p><pre><code class="language-julia hljs"># σ: Total 3D velocity dispersion = √(σx² + σy² + σz²)
# σx, σy, σz: Velocity dispersions along coordinate axes
proj_z = projection(particles, [:v, :σ, :σx, :σy, :σz, :ekin],
                    units=[:km_s,:km_s,:km_s,:km_s,:km_s,:erg],
                    lmax=9,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[24.,24.,24.], range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:31.788

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 512^2
Pixel size: 93.75 [pc]
Simulation min.: 46.875 [pc]
</code></pre><p>For the velocity dispersion additional maps are created that lead to the mass-weighted quantity: E. g.: σx = sqrt( &lt;vx^2&gt; - &lt; vx &gt;^2 )</p><pre><code class="language-julia hljs">proj_z.maps # NaN indicates that there are no particles for the available grid.</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 14 entries:
  :ekin =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :sd   =&gt; [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0; 0.0 0.…
  :v    =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :v2   =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :vx   =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :vx2  =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :vy   =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :vy2  =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :vz   =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :vz2  =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :σ    =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :σx   =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :σy   =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…
  :σz   =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN; NaN Na…</code></pre><pre><code class="language-julia hljs">proj_z.maps_unit</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 14 entries:
  :ekin =&gt; :erg
  :sd   =&gt; :standard
  :v    =&gt; :km_s
  :v2   =&gt; :standard
  :vx   =&gt; :standard
  :vx2  =&gt; :standard
  :vy   =&gt; :standard
  :vy2  =&gt; :standard
  :vz   =&gt; :standard
  :vz2  =&gt; :standard
  :σ    =&gt; :km_s
  :σx   =&gt; :km_s
  :σy   =&gt; :km_s
  :σz   =&gt; :km_s</code></pre><pre><code class="language-julia hljs">usedmemory(proj_z);</code></pre><pre><code class="nohighlight hljs">Memory used: 4.919 MB
</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 5.5))

subplot(2, 3, 1)
title(&quot;v [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:v])  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent, vmax=300.)
colorbar()

subplot(2, 3, 2)
title(&quot;σ [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σ])  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 3)
title(&quot;Ekin [erg]&quot;)
imshow( log10.(permutedims(proj_z.maps[:ekin]) ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 4)
title(&quot;σx [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σx])   ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 5)
title(&quot;σy [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σy])  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 6)
title(&quot;σz [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σz])  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_56_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x550 with 12 Axes&gt;)</code></pre><h4 id="Use-quantities-in-cylindrical-coordinates:"><a class="docs-heading-anchor" href="#Use-quantities-in-cylindrical-coordinates:">Use quantities in cylindrical coordinates:</a><a id="Use-quantities-in-cylindrical-coordinates:-1"></a><a class="docs-heading-anchor-permalink" href="#Use-quantities-in-cylindrical-coordinates:" title="Permalink"></a></h4><h4 id="Face-on-disc-(z-direction)"><a class="docs-heading-anchor" href="#Face-on-disc-(z-direction)">Face-on disc (z-direction)</a><a id="Face-on-disc-(z-direction)-1"></a><a class="docs-heading-anchor-permalink" href="#Face-on-disc-(z-direction)" title="Permalink"></a></h4><p>For the cylindrical or spherical components of a quantity, the center of the coordinate system is used (keywords: data<em>center = center default) and can be given with the keyword &quot;data</em>center&quot; and its units with &quot;data<em>center</em>unit&quot;. Additionally, the quantities that are based on cartesian coordinates can be given.</p><pre><code class="language-julia hljs"># σr_cylinder: Radial velocity dispersion in cylindrical coordinates
# σϕ_cylinder: Azimuthal velocity dispersion (tangential motions)
proj_z = projection(particles, [:v, :σ, :σx, :σy, :ϕ, :r_cylinder, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
                    units=[:km_s,:km_s,:km_s, :km_s, :standard, :kpc, :km_s, :km_s, :km_s, :km_s],
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:boxcenter], range_unit=:kpc,
                    data_center=[24.,24.,24.], data_center_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:34.805

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 1024^2
Pixel size: 46.875 [pc]
Simulation min.: 46.875 [pc]
</code></pre><pre><code class="language-julia hljs">proj_z.maps</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 18 entries:
  :r_cylinder   =&gt; [14.0758 14.0427 … 14.1201 14.1534; 14.0427 14.0096 … 14.087…
  :sd           =&gt; [0.0 0.0 … 0.0 0.0; 0.0 0.0 … 0.0 0.0; … ; 0.0 0.0 … 0.0 0.0…
  :v            =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :v2           =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vr_cylinder  =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vr_cylinder2 =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vx           =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vx2          =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vy           =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vy2          =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vϕ_cylinder  =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :vϕ_cylinder2 =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :σ            =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :σr_cylinder  =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :σx           =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :σy           =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :σϕ_cylinder  =&gt; [NaN NaN … NaN NaN; NaN NaN … NaN NaN; … ; NaN NaN … NaN NaN…
  :ϕ            =&gt; [3.92699 3.92463 … 2.35306 2.35073; 3.92935 3.92699 … 2.3507…</code></pre><pre><code class="language-julia hljs">proj_z.maps_unit</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 18 entries:
  :r_cylinder   =&gt; :kpc
  :sd           =&gt; :standard
  :v            =&gt; :km_s
  :v2           =&gt; :standard
  :vr_cylinder  =&gt; :km_s
  :vr_cylinder2 =&gt; :standard
  :vx           =&gt; :standard
  :vx2          =&gt; :standard
  :vy           =&gt; :standard
  :vy2          =&gt; :standard
  :vϕ_cylinder  =&gt; :km_s
  :vϕ_cylinder2 =&gt; :standard
  :σ            =&gt; :km_s
  :σr_cylinder  =&gt; :km_s
  :σx           =&gt; :km_s
  :σy           =&gt; :km_s
  :σϕ_cylinder  =&gt; :km_s
  :ϕ            =&gt; :radian</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 8.5))

subplot(3, 3, 1)
title(&quot;Radius [kpc]&quot;)
imshow( permutedims(proj_z.maps[:r_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 2)
title(&quot;vr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vr_cylinder] ), cmap=&quot;seismic&quot;, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-50.,vmax=50.)
colorbar()

subplot(3, 3, 3)
title(&quot;vϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vϕ_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 4)
title(&quot;ϕ-angle&quot;)
imshow( (permutedims(proj_z.maps[:ϕ]) ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 5)
title(&quot;σr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σr_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 6)
title(&quot;σϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σϕ_cylinder] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 7)
title(&quot;σ [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σ]) ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 8)
title(&quot;σx [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σx]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 9)
title(&quot;σy [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σy] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_61_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x850 with 18 Axes&gt;)</code></pre><h2 id="Project-on-a-Coarser-Grid"><a class="docs-heading-anchor" href="#Project-on-a-Coarser-Grid">Project on a Coarser Grid</a><a id="Project-on-a-Coarser-Grid-1"></a><a class="docs-heading-anchor-permalink" href="#Project-on-a-Coarser-Grid" title="Permalink"></a></h2><h3 id="lmax"><a class="docs-heading-anchor" href="#lmax">lmax</a><a id="lmax-1"></a><a class="docs-heading-anchor-permalink" href="#lmax" title="Permalink"></a></h3><p>The default is the projection on the maximum loaded grid level (always provided in the output). Choose a smaller/larger level with the keyword <code>lmax</code> (independend on the maximum level of the simulation) to project on a coarser/finer grid. By default, the data is assumed to be in the center of the simulation box.</p><pre><code class="language-julia hljs"># lmax=6: Uses AMR level 6 → 2^6 = 64x64 effective grid cells
proj_z = projection(particles,
                    [:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
                    :km_s,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:boxcenter], range_unit=:kpc,
                    lmax=6);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:38.034

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 64^2
Pixel size: 750.0 [pc]
Simulation min.: 46.875 [pc]
</code></pre><p>The projection onto the maximum loaded grid is always provided:</p><pre><code class="language-julia hljs">proj_z.maps</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 19 entries:
  :sd           =&gt; [3.6988e-5 6.11725e-5 … 2.84523e-5 4.26785e-6; 0.000146885 8…
  :v            =&gt; [215.727 217.893 … 213.689 211.398; 211.909 214.371 … 215.29…
  :v2           =&gt; [10.8327 11.0472 … 10.6218 10.3945; 10.4511 10.6909 … 10.782…
  :vr_cylinder  =&gt; [-4.97035 9.83744 … 0.326624 -5.23378; -8.36334 3.71396 … 7.…
  :vr_cylinder2 =&gt; [0.0231364 0.0346302 … 0.0196151 0.0344127; 0.0339309 0.0312…
  :vx           =&gt; [2.38824 2.13472 … -2.30736 -2.28246; 2.4166 2.28742 … -2.49…
  :vx2          =&gt; [5.71099 4.56492 … 5.33794 5.23511; 5.844 5.24859 … 6.2532 6…
  :vy           =&gt; [-2.25778 -2.54366 … -2.29652 -2.26901; -2.14059 -2.32778 … …
  :vy2          =&gt; [5.12035 6.48209 … 5.28291 5.15929; 4.60593 5.44099 … 4.5285…
  :vz           =&gt; [-0.032174 0.00624848 … -0.0229633 0.00636579; -0.0269481 -0…
  :vz2          =&gt; [0.00140393 0.000219812 … 0.000962049 0.000127987; 0.0011519…
  :vϕ_cylinder  =&gt; [215.479 217.553 … 213.481 211.046; 211.546 214.042 … 214.91…
  :vϕ_cylinder2 =&gt; [10.8082 11.0124 … 10.6012 10.36; 10.416 10.6583 … 10.7443 1…
  :σ            =&gt; [6.62266 5.19183 … 3.45808 2.9201; 5.96424 4.11213 … 3.61926…
  :σr_cylinder  =&gt; [8.64782 7.22072 … 9.17826 10.9812; 8.71558 10.9816 … 10.005…
  :σx           =&gt; [5.59831 5.83217 … 7.77318 10.4683; 4.16244 8.36784 … 6.5268…
  :σy           =&gt; [9.89835 7.14297 … 6.19364 6.84324; 10.118 9.82426 … 9.42142…
  :σz           =&gt; [1.25926 0.88166 … 1.36727 0.613275; 1.35303 2.02241 … 1.188…
  :σϕ_cylinder  =&gt; [6.7421 5.02267 … 3.52611 2.97303; 6.19423 4.23835 … 3.69795…</code></pre><pre><code class="language-julia hljs">proj_z.maps_unit</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 19 entries:
  :sd           =&gt; :standard
  :v            =&gt; :km_s
  :v2           =&gt; :standard
  :vr_cylinder  =&gt; :km_s
  :vr_cylinder2 =&gt; :standard
  :vx           =&gt; :standard
  :vx2          =&gt; :standard
  :vy           =&gt; :standard
  :vy2          =&gt; :standard
  :vz           =&gt; :standard
  :vz2          =&gt; :standard
  :vϕ_cylinder  =&gt; :km_s
  :vϕ_cylinder2 =&gt; :standard
  :σ            =&gt; :km_s
  :σr_cylinder  =&gt; :km_s
  :σx           =&gt; :km_s
  :σy           =&gt; :km_s
  :σz           =&gt; :km_s
  :σϕ_cylinder  =&gt; :km_s</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 8.5))

subplot(3, 3, 1)
title(&quot;|v| [km/s]&quot;)
imshow( permutedims(proj_z.maps[:v]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent, vmax=300.)
colorbar()

subplot(3, 3, 2)
title(&quot;vr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vr_cylinder] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-200.,vmax=200.)
colorbar()

subplot(3, 3, 3)
title(&quot;vϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vϕ_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 4)
title(&quot;σz [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σz]) ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 5)
title(&quot;σr [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σr_cylinder]  )), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 6)
title(&quot;σϕ [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σϕ_cylinder] )), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 7)
title(&quot;σ [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σ]) ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 8)
title(&quot;σx [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σx]  )), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 9)
title(&quot;σy [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σy] )), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_67_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x850 with 18 Axes&gt;)</code></pre><h3 id="res"><a class="docs-heading-anchor" href="#res">res</a><a id="res-1"></a><a class="docs-heading-anchor-permalink" href="#res" title="Permalink"></a></h3><p>Choose the effective resolution (related to the full box) of the projected grid:</p><pre><code class="language-julia hljs"># res=100: Forces 100x100 effective grid
proj_z = projection(particles,
                    [:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
                    :km_s,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:boxcenter], range_unit=:kpc,
                    res=100);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:39.426

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 100^2
Pixel size: 480.0 [pc]
Simulation min.: 46.875 [pc]
</code></pre><h3 id="pxsize"><a class="docs-heading-anchor" href="#pxsize">pxsize</a><a id="pxsize-1"></a><a class="docs-heading-anchor-permalink" href="#pxsize" title="Permalink"></a></h3><p>Choose the pixel size in a physical unit, e.g. pixel-size=100 pc. The data is projected to a grid with a pixel-size that is closest to the given number, but not larger:</p><pre><code class="language-julia hljs"># pxsize=[100.,:pc]: Each pixel represents ~100 pc physical size
proj_z = projection(particles,
                    [:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
                    :km_s,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:boxcenter], range_unit=:kpc,
                    pxsize=[100., :pc]);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:40.202

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Effective resolution: 481^2
Pixel size: 99.792 [pc]
Simulation min.: 46.875 [pc]
</code></pre><h2 id="Projection-of-the-Birth/Age-Time"><a class="docs-heading-anchor" href="#Projection-of-the-Birth/Age-Time">Projection of the Birth/Age-Time</a><a id="Projection-of-the-Birth/Age-Time-1"></a><a class="docs-heading-anchor-permalink" href="#Projection-of-the-Birth/Age-Time" title="Permalink"></a></h2><p>Project the average birth-time of the particles to the grid:</p><pre><code class="language-julia hljs"># :birth - Absolute formation time in simulation units (when star formed)
proj_z = projection(particles, :birth, :Myr,
                    lmax=8,  zrange=[0.45,0.55], center=[0.,0.,0.], verbose=false);
proj_x = projection(particles, :birth, :Myr,
                    lmax=8,  zrange=[0.45,0.55], center=[0.,0.,0.], direction=:x, verbose=false);</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:birth])), cmap=cmap2, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(Birth) \ [Myr]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:birth])), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_x.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(Birth) \ [Myr]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);
tight_layout()</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_75_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><p>Project the average age of the particles to the grid. The age is taken relative to the loaded snapshot time by default.</p><pre><code class="language-julia hljs"># :age - Relative age = snapshot_time - birth_time (how old star is now)
proj_z = projection(particles, :age, :Myr,
                    lmax=8,  zrange=[0.45,0.55], center=[0.,0.,0.], verbose=false);
proj_x = projection(particles, :age, :Myr,
                    lmax=8,  zrange=[0.45,0.55], direction=:x,  center=[0.,0.,0.], verbose=false);</code></pre><p>The reference time (code units) for the age calculation:</p><pre><code class="language-julia hljs">proj_z.ref_time</code></pre><pre><code class="nohighlight hljs">29.9031937665063</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:age])), cmap=cmap2, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(Age) \ [Myr]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:age])), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_x.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(Age) \ [Myr]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);
tight_layout()</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_80_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><p>Project the average age of the particles relative to a given reference time:</p><pre><code class="language-julia hljs">proj_z = projection(particles, :age, :Myr, ref_time=0.,
                    lmax=8,  zrange=[0.45,0.55], center=[0.,0.,0.], verbose=false);
proj_x = projection(particles, :age, :Myr, ref_time = 0.,
                    lmax=8,  zrange=[0.45,0.55], center=[0.,0.,0.], direction=:x, verbose=false);</code></pre><p>The reference time (code units) for the age calculation:</p><pre><code class="language-julia hljs">proj_z.ref_time</code></pre><pre><code class="nohighlight hljs">0.0</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( ( permutedims(proj_z.maps[:age])), cmap=cmap2, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{Age \ [Myr]}&quot;)

subplot(1,2,2)
im = imshow( ( permutedims(proj_x.maps[:age])), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_x.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{Age \ [Myr]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);
tight_layout()</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_85_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><h2 id="Projection-of-Masked-Data"><a class="docs-heading-anchor" href="#Projection-of-Masked-Data">Projection of Masked Data</a><a id="Projection-of-Masked-Data-1"></a><a class="docs-heading-anchor-permalink" href="#Projection-of-Masked-Data" title="Permalink"></a></h2><p>Mask particles with ages higher than 400 Myr by creating a Bool-array where the smaller ages correspond to false entries:</p><pre><code class="language-julia hljs">mask = getvar(particles, :age, :Myr) .&gt; 400. ;</code></pre><pre><code class="language-julia hljs">proj_z = projection(particles, :age, :Myr, mask=mask,
                    lmax=8,  zrange=[0.45,0.55], center=[0.,0.,0.]);
proj_x = projection(particles, :age, :Myr, mask=mask,
                    lmax=8,  zrange=[0.45,0.55], center=[0.,0.,0.], direction=:x);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:02:42.255

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.45 :: 0.55  	==&gt; 21.6 [kpc] :: 26.4 [kpc]

Effective resolution: 256^2
Pixel size: 187.5 [pc]
Simulation min.: 46.875 [pc]

:mask provided by function

[Mera]: 2025-08-14T15:02:43.103

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.45 :: 0.55  	==&gt; 21.6 [kpc] :: 26.4 [kpc]

Effective resolution: 256^2
Pixel size: 187.5 [pc]
Simulation min.: 46.875 [pc]

:mask provided by function
</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:age])), cmap=cmap2, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(Age) \ [Myr]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:age])), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_x.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(Age) \ [Myr]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);
tight_layout()</code></pre><p><img src="../06_particles_Projection_files/06_particles_Projection_90_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><h3 id="Key-Accomplishments"><a class="docs-heading-anchor" href="#Key-Accomplishments">Key Accomplishments</a><a id="Key-Accomplishments-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Accomplishments" title="Permalink"></a></h3><p>In this tutorial, you have learned to:</p><ul><li>Create basic particle projections with mass weighting</li><li>Configure custom resolution and spatial extent</li><li>Generate projections along different axes</li><li>Perform age-based stellar population analysis</li><li>Access and analyze projection data arrays</li></ul><h3 id="Particle-Projection-Capabilities"><a class="docs-heading-anchor" href="#Particle-Projection-Capabilities">Particle Projection Capabilities</a><a id="Particle-Projection-Capabilities-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Projection-Capabilities" title="Permalink"></a></h3><ul><li><strong>Stellar Properties</strong>: Mass, age, metallicity, birth time projections</li><li><strong>Kinematic Analysis</strong>: Velocity component projections</li><li><strong>Population Studies</strong>: Age gradients and stellar distribution analysis</li><li><strong>Multi-component</strong>: Separate star and dark matter projections</li><li><strong>Custom Weighting</strong>: Mass-weighted or number-weighted projections</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../06_hydro_Projection/">« Hydro</a><a class="docs-footer-nextpage" href="../api/projections/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">© 2025 Manuel Behrendt. Built with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and <a href="https://julialang.org">Julia</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 27 August 2025 07:51">Wednesday 27 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
