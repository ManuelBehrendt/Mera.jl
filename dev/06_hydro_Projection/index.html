<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hydro · Mera.jl</title><meta name="title" content="Hydro · Mera.jl"/><meta property="og:title" content="Hydro · Mera.jl"/><meta property="twitter:title" content="Hydro · Mera.jl"/><meta name="description" content="Documentation for Mera.jl."/><meta property="og:description" content="Documentation for Mera.jl."/><meta property="twitter:description" content="Documentation for Mera.jl."/><meta property="og:url" content="https://manuelbehrendt.github.io/Mera.jl/06_hydro_Projection/"/><meta property="twitter:url" content="https://manuelbehrendt.github.io/Mera.jl/06_hydro_Projection/"/><link rel="canonical" href="https://manuelbehrendt.github.io/Mera.jl/06_hydro_Projection/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../assets/custom.js"></script><script src="../assets/music_player.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="Mera.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../00_multi_FirstSteps/">Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Core Workflows</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Data Inspection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01_hydro_First_Inspection/">Hydro</a></li><li><a class="tocitem" href="../01_particles_First_Inspection/">Particles</a></li><li><a class="tocitem" href="../01_clumps_First_Inspection/">Clumps</a></li><li><a class="tocitem" href="../api/data_inspection/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Load by Selection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../02_hydro_Load_Selections/">Hydro</a></li><li><a class="tocitem" href="../02_particles_Load_Selections/">Particles</a></li><li><a class="tocitem" href="../02_clumps_Load_Selections/">Clumps</a></li><li><a class="tocitem" href="../api/data_loading/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Get Subregions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../03_hydro_Get_Subregions/">Hydro</a></li><li><a class="tocitem" href="../03_particles_Get_Subregions/">Particles</a></li><li><a class="tocitem" href="../03_clumps_Get_Subregions/">Clumps</a></li><li><a class="tocitem" href="../api/subregions/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Analysis &amp; Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Basic Calculations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../04_multi_Basic_Calculations/">Tutorial</a></li><li><a class="tocitem" href="../api/calculations/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Mask/Filter/Meta</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../05_multi_Masking_Filtering/">Tutorial</a></li><li><a class="tocitem" href="../api/masking_filtering/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Projection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Hydro</a><ul class="internal"><li><a class="tocitem" href="#Quick-Reference"><span>Quick Reference</span></a></li><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Key-Concepts"><span>Key Concepts</span></a></li><li><a class="tocitem" href="#Environment-Setup-and-Data-Loading"><span>Environment Setup and Data Loading</span></a></li><li><a class="tocitem" href="#Basic-Projections"><span>Basic Projections</span></a></li><li><a class="tocitem" href="#Projection-Output-Structure"><span>Projection Output Structure</span></a></li><li><a class="tocitem" href="#Visualization-and-Plotting"><span>Visualization and Plotting</span></a></li><li><a class="tocitem" href="#Advanced-Kinematic-Analysis"><span>Advanced Kinematic Analysis</span></a></li><li><a class="tocitem" href="#Grid-Resolution-Control"><span>Grid Resolution Control</span></a></li><li><a class="tocitem" href="#Thermal-Properties-Analysis"><span>Thermal Properties Analysis</span></a></li><li><a class="tocitem" href="#Selective-Data-Analysis"><span>Selective Data Analysis</span></a></li><li><a class="tocitem" href="#Weighting-and-Integration-Schemes"><span>Weighting and Integration Schemes</span></a></li><li><a class="tocitem" href="#Specialized-Applications"><span>Specialized Applications</span></a></li><li><a class="tocitem" href="#Summary"><span>Summary</span></a></li></ul></li><li><a class="tocitem" href="../06_particles_Projection/">Particles</a></li><li><a class="tocitem" href="../api/projections/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Data &amp; Visualization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-5-1" type="checkbox"/><label class="tocitem" for="menuitem-5-1"><span class="docs-label">MERA-Files</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../07_multi_Mera_Files/">Mera-Files</a></li><li><a class="tocitem" href="../07_1_multi_Mera_Files_Converter/">Converter</a></li><li><a class="tocitem" href="../api/mera_files/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Volume Rendering</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../paraview/paraview_intro/">Intro</a></li><li><a class="tocitem" href="../paraview/08_hydro_VTK_export/">Hydro</a></li><li><a class="tocitem" href="../paraview/08_particles_VTK_export/">Particles</a></li><li><a class="tocitem" href="../api/volume_rendering/">API Reference</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">Advanced Features</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-6-1" type="checkbox"/><label class="tocitem" for="menuitem-6-1"><span class="docs-label">Multi-Threading</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../multi-threading/multi-threading_intro/">Tutorial</a></li><li><a class="tocitem" href="../api/multithreading/">API Reference</a></li></ul></li><li><a class="tocitem" href="../advanced_features/testing_guide/">Testing Framework</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Notifications</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../notifications/">Overview</a></li><li><a class="tocitem" href="../notifications/01_quick_start/">Quick Start</a></li><li><a class="tocitem" href="../notifications/02_setup/">Setup Guide</a></li><li><a class="tocitem" href="../notifications/bell/">Bell (Local Audio)</a></li><li><a class="tocitem" href="../notifications/email/">Email</a></li><li><a class="tocitem" href="../notifications/zulip/">Zulip (Team Chat)</a></li><li><a class="tocitem" href="../notifications/zulip_templates/">Zulip Templates</a></li><li><a class="tocitem" href="../notifications/03_attachments/">File Attachments</a></li><li><a class="tocitem" href="../notifications/04_output_capture/">Output Capture</a></li><li><a class="tocitem" href="../notifications/05_advanced/">Advanced Features</a></li><li><a class="tocitem" href="../notifications/06_examples/">Examples</a></li><li><a class="tocitem" href="../notifications/07_troubleshooting/">Troubleshooting</a></li><li><a class="tocitem" href="../api/notifications/">API Reference</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../benchmarks/IO/IOperformance/">Server IO</a></li><li><a class="tocitem" href="../benchmarks/RAMSES_reading/ramses_reading/">Parallel RAMSES-Files Reading</a></li><li><a class="tocitem" href="../benchmarks/JLD2_reading/Mera_files_reading/">Mera-Files Reading</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Julia Quick Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../quickreference/01_getting_started/">Getting Started</a></li><li><a class="tocitem" href="../quickreference/02_migrators/">From Other Languages</a></li><li><a class="tocitem" href="../quickreference/03_packages/">Essential Packages</a></li><li><a class="tocitem" href="../quickreference/04_mera_patterns/">Julia Fundamentals</a></li><li><a class="tocitem" href="../quickreference/05_performance/">Performance &amp; Debugging</a></li><li><a class="tocitem" href="../quickreference/06_resources/">Resources &amp; Community</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Examples &amp; Reference</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/">Examples</a></li><li><a class="tocitem" href="../Miscellaneous/">Miscellaneous</a></li><li><a class="tocitem" href="../api/">Complete API Reference</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Analysis &amp; Calculations</a></li><li><a class="is-disabled">Projection</a></li><li class="is-active"><a href>Hydro</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hydro</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/ManuelBehrendt/Mera.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hydro-Data-Projections"><a class="docs-heading-anchor" href="#Hydro-Data-Projections">Hydro Data Projections</a><a id="Hydro-Data-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Hydro-Data-Projections" title="Permalink"></a></h1><p>This tutorial demonstrates advanced projection techniques for hydrodynamical simulation data using MERA.jl. Learn how to create 2D projections from 3D data, handle different coordinate systems, and visualize complex astrophysical datasets.</p><h2 id="Quick-Reference"><a class="docs-heading-anchor" href="#Quick-Reference">Quick Reference</a><a id="Quick-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Reference" title="Permalink"></a></h2><h3 id="Essential-Functions"><a class="docs-heading-anchor" href="#Essential-Functions">Essential Functions</a><a id="Essential-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Essential-Functions" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Basic projection
projection(data, :variable, :unit)

# Multi-quantity projection
projection(data, [:var1, :var2], units=[:unit1, :unit2])

# Spatial selection
projection(data, :sd, :Msol_pc2,
          xrange=[-10,10], center=[:boxcenter], range_unit=:kpc)

# Direction control
projection(data, :sd, :Msol_pc2, direction=:x)  # x, y, z directions

# Resolution control
projection(data, :sd, :Msol_pc2, lmax=8)        # AMR level
projection(data, :sd, :Msol_pc2, res=256)       # Effective grid resolution
projection(data, :sd, :Msol_pc2, pxsize=[100.,:pc])  # Physical pixel size

# Masking and weighting
projection(data, :sd, :Msol_pc2, mask=mask_array)
projection(data, :rho, :g_cm3, weighting=[:volume])</code></pre><h3 id="Key-Projection-Quantities"><a class="docs-heading-anchor" href="#Key-Projection-Quantities">Key Projection Quantities</a><a id="Key-Projection-Quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Projection-Quantities" title="Permalink"></a></h3><ul><li><strong><code>:sd</code></strong> - Surface density (Σ)</li><li><strong><code>:vx, :vy, :vz</code></strong> - Velocity components</li><li><strong><code>:v</code></strong> - Total velocity magnitude</li><li><strong><code>:σ, :σx, :σy, :σz</code></strong> - Velocity dispersions</li><li><strong><code>:cs</code></strong> - Sound speed</li><li><strong><code>:r_cylinder, :vr_cylinder, :vϕ_cylinder</code></strong></li><li><strong><code>:ϕ, :σr_cylinder, :σϕ_cylinder</code></strong></li></ul><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>MERA.jl provides powerful projection capabilities for analyzing hydrodynamical simulations:</p><ul><li><strong>Surface density projections</strong> in arbitrary directions</li><li><strong>Kinematic analysis</strong> with velocity fields and dispersions</li><li><strong>Multi-quantity projections</strong> with customizable units</li><li><strong>Coordinate system transformations</strong> (Cartesian, cylindrical, spherical)</li><li><strong>Advanced masking and filtering</strong> for targeted analysis</li></ul><h2 id="Key-Concepts"><a class="docs-heading-anchor" href="#Key-Concepts">Key Concepts</a><a id="Key-Concepts-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Concepts" title="Permalink"></a></h2><ul><li><strong>Projection Direction</strong>: Control viewing angle (x, y, z directions)</li><li><strong>Grid Resolution</strong>: Customize output resolution via <code>lmax</code>, <code>res</code>, or <code>pxsize</code></li><li><strong>Weighting Schemes</strong>: Mass-weighted, volume-weighted, or custom weighting</li><li><strong>Coordinate Systems</strong>: Native Cartesian or derived cylindrical/spherical coordinates</li></ul><h2 id="Environment-Setup-and-Data-Loading"><a class="docs-heading-anchor" href="#Environment-Setup-and-Data-Loading">Environment Setup and Data Loading</a><a id="Environment-Setup-and-Data-Loading-1"></a><a class="docs-heading-anchor-permalink" href="#Environment-Setup-and-Data-Loading" title="Permalink"></a></h2><h3 id="Package-Configuration"><a class="docs-heading-anchor" href="#Package-Configuration">Package Configuration</a><a id="Package-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Configuration" title="Permalink"></a></h3><p>First, we configure the development environment and load the required packages for this tutorial.</p><pre><code class="language-julia hljs">using Mera

# Load simulation metadata
# Replace with your simulation path and output number
info = getinfo(400, &quot;/Volumes/FASTStorage/Simulations/Mera-Tests/manu_sim_sf_L14&quot;)

# Load hydrodynamical data with specified constraints
# smallr: sets minimum density value in loaded data, lmax: maximum level to load
gas = gethydro(info, smallr=1e-11, lmax=12);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:56:54.147

Code: RAMSES
output [400] summary:
mtime: 2018-09-05T09:51:55
ctime: 2025-06-29T20:06:45.267
=======================================================
simulation time: 594.98 [Myr]
boxlen: 48.0 [kpc]
ncpu: 2048
ndim: 3
-------------------------------------------------------
amr:           true
level(s): 6 - 14 --&gt; cellsize(s): 750.0 [pc] - 2.93 [pc]
-------------------------------------------------------
hydro:         true
hydro-variables:  7  --&gt; (:rho, :vx, :vy, :vz, :p, :var6, :var7)
hydro-descriptor: (:density, :velocity_x, :velocity_y, :velocity_z, :thermal_pressure, :passive_scalar_1, :passive_scalar_2)
γ: 1.6667
-------------------------------------------------------
gravity:       true
gravity-variables: (:epot, :ax, :ay, :az)
-------------------------------------------------------
particles:     true
- Npart:    5.091500e+05
- Nstars:   5.066030e+05
- Ndm:      2.547000e+03
particle-variables: 5  --&gt; (:vx, :vy, :vz, :mass, :birth)
-------------------------------------------------------
rt:            false
-------------------------------------------------------
clumps:           true
clump-variables: (:index, :lev, :parent, :ncell, :peak_x, :peak_y, :peak_z, Symbol(&quot;rho-&quot;), Symbol(&quot;rho+&quot;), :rho_av, :mass_cl, :relevance)
-------------------------------------------------------
namelist-file:    false
timer-file:       false
compilation-file: true
makefile:         true
patchfile:        true
=======================================================

[Mera]: Get hydro data: 2025-08-14T14:56:56.389

Key vars=(:level, :cx, :cy, :cz)
Using var(s)=(1, 2, 3, 4, 5, 6, 7) = (:rho, :vx, :vy, :vz, :p, :var6, :var7)

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]

📊 Processing Configuration:
   Total CPU files available: 2048
   Files to be processed: 2048
   Compute threads: 8
   GC threads: 4
</code></pre><pre><code class="nohighlight hljs">Processing files: 100%|██████████████████████████████████████████████████| Time: 0:01:08 (33.26 ms/it)
</code></pre><pre><code class="nohighlight hljs">
✓ File processing complete! Combining results...
✓ Data combination complete!
Final data size: 18966620 cells, 7 variables
Creating Table from 18966620 cells with max 8 threads...
  Threading: 8 threads for 11 columns
  Max threads requested: 8
  Available threads: 8
  Using parallel processing with 8 threads
  Creating IndexedTable with 11 columns...
 17.532129 seconds (500.23 M allocations: 19.436 GiB, 5.14% gc time, 5.19% compilation time)
✓ Table created in 17.719 seconds
Memory used for data table :1.5544367535039783 GB
-------------------------------------------------------
</code></pre><pre><code class="language-julia hljs"># Inspect the loaded hydro data structure
# This shows the available fields and data organization
gas.data</code></pre><pre><code class="nohighlight hljs">Table with 18966620 rows, 11 columns:
Columns:
#   colname  type
────────────────────
1   level    Int64
2   cx       Int64
3   cy       Int64
4   cz       Int64
5   rho      Float64
6   vx       Float64
7   vy       Float64
8   vz       Float64
9   p        Float64
10  var6     Float64
11  var7     Float64</code></pre><h2 id="Basic-Projections"><a class="docs-heading-anchor" href="#Basic-Projections">Basic Projections</a><a id="Basic-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Projections" title="Permalink"></a></h2><h3 id="Available-Projection-Quantities"><a class="docs-heading-anchor" href="#Available-Projection-Quantities">Available Projection Quantities</a><a id="Available-Projection-Quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Projection-Quantities" title="Permalink"></a></h3><p>MERA.jl provides numerous predefined quantities for projection analysis. Understanding available options helps select appropriate variables for your scientific goals.</p><p>The <code>projection()</code> function without arguments displays all available projection quantities. This includes fundamental physical properties, derived quantities, and coordinate system transformations:</p><pre><code class="language-julia hljs"># Display all available projection quantities and their symbols
projection()</code></pre><pre><code class="nohighlight hljs">Predefined vars for projections:
------------------------------------------------
=====================[gas]:=====================
       -all the non derived hydro vars-
:cpu, :level, :rho, :cx, :cy, :cz, :vx, :vy, :vz, :p, var6,...
further possibilities: :rho, :density, :ρ
              -derived hydro vars-
:x, :y, :z
:sd or :Σ or :surfacedensity
:mass, :cellsize, :freefall_time
:cs, :mach, :machx, :machy, :machz, :jeanslength, :jeansnumber
:t, :Temp, :Temperature with p/rho

==================[particles]:==================
        all the non derived  vars:
:cpu, :level, :id, :family, :tag
:x, :y, :z, :vx, :vy, :vz, :mass, :birth, :metal....

              -derived particle vars-
:age

==============[gas or particles]:===============
:v, :ekin
squared =&gt; :vx2, :vy2, :vz2
velocity dispersion =&gt; σx, σy, σz, σ

related to a given center:
---------------------------
:vr_cylinder, vr_sphere (radial components)
:vϕ_cylinder, :vθ
squared =&gt; :vr_cylinder2, :vϕ_cylinder2
velocity dispersion =&gt; σr_cylinder, σϕ_cylinder

2d maps (not projected) =&gt; :r_cylinder, :ϕ

------------------------------------------------
</code></pre><h3 id="Single-Quantity-Projections"><a class="docs-heading-anchor" href="#Single-Quantity-Projections">Single Quantity Projections</a><a id="Single-Quantity-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Single-Quantity-Projections" title="Permalink"></a></h3><h4 id="Directional-Projections-(z,-y,-x)"><a class="docs-heading-anchor" href="#Directional-Projections-(z,-y,-x)">Directional Projections (z, y, x)</a><a id="Directional-Projections-(z,-y,-x)-1"></a><a class="docs-heading-anchor-permalink" href="#Directional-Projections-(z,-y,-x)" title="Permalink"></a></h4><p>Surface density projections integrate mass along a chosen axis, creating 2D maps that reveal structure and distribution patterns.</p><p><strong>Key Parameters:</strong></p><ul><li><strong>Variable Selection</strong>: <code>:sd</code> (surface density) symbol for projection quantity</li><li><strong>Unit Specification</strong>: <code>:Msol_pc2</code> for solar masses per square parsec</li><li><strong>Range Control</strong>: <code>zrange</code> defines integration depth along projection axis</li><li><strong>Threading</strong>: <code>verbose_threads=true</code> shows parallel processing information</li></ul><p><strong>Technical Notes:</strong></p><ul><li>Default projection direction is z-axis (viewing from above)</li><li>Grid resolution matches maximum loaded refinement level</li><li>Mass-weighted integration by default for surface density</li></ul><pre><code class="language-julia hljs"># Z-direction projection (view from above)
# Integrates mass along z-axis: Σ(x,y) = ∫ ρ(x,y,z) dz
proj_z = projection(gas, :sd, unit=:Msol_pc2, zrange=[0.45,0.55], verbose_threads=true)

# Alternative syntax: omit &#39;unit&#39; keyword if order is preserved
proj_z = projection(gas, :sd, :Msol_pc2, zrange=[0.45,0.55], verbose=false)

# X-direction projection (side view)
# Integrates mass along x-axis: Σ(y,z) = ∫ ρ(x,y,z) dx
# Shows structure when viewed from the side
proj_x = projection(gas, :sd, :Msol_pc2, direction=:x, zrange=[0.45,0.55], verbose=false);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:28.184

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.45 :: 0.55  	==&gt; 21.6 [kpc] :: 26.4 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 4096 x 4096
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
ℹ️  Sequential: Insufficient variables (1 &lt; 2)
</code></pre><pre><code class="nohighlight hljs">Progress: 100%|█████████████████████████████████████████| Time: 0:00:03
Progress: 100%|█████████████████████████████████████████| Time: 0:00:03
Progress: 100%|█████████████████████████████████████████| Time: 0:00:03
</code></pre><h4 id="Spatial-Range-Selection"><a class="docs-heading-anchor" href="#Spatial-Range-Selection">Spatial Range Selection</a><a id="Spatial-Range-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Spatial-Range-Selection" title="Permalink"></a></h4><p>Control the spatial region for projection analysis by specifying coordinate ranges relative to a chosen center point. This enables focused analysis of specific structures or regions of interest.</p><pre><code class="language-julia hljs"># Define center point: box center in physical units
cv = (gas.boxlen / 2.) * gas.scale.kpc  # Convert to kpc

# Project specific spatial region around center
proj_z = projection(gas, :sd, :Msol_pc2,
                    xrange=[-10.,10.],     # ±10 kpc in x-direction
                    yrange=[-10.,10.],     # ±10 kpc in y-direction
                    zrange=[-2.,2.],       # ±2 kpc integration depth
                    center=[cv,cv,cv],     # Center at box center
                    range_unit=:kpc);       # Specify range units</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:43.535

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 1708
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
</code></pre><p><strong>Convenience Notation for Box Center:</strong></p><p>Use shorthand notation <code>:bc</code> or <code>:boxcenter</code> to automatically reference the simulation box center without manual calculation:</p><pre><code class="language-julia hljs"># Use :boxcenter shorthand for automatic box center calculation
proj_z = projection(gas, :sd, :Msol_pc2,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:boxcenter],   # Automatic box center
                    range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:46.040

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 1708
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
</code></pre><pre><code class="language-julia hljs"># Alternative abbreviated notation
proj_z = projection(gas, :sd, :Msol_pc2,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:bc],          # :bc shorthand for box center
                    range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:47.854

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 1708
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
</code></pre><p><strong>Dimension-Specific Center Control:</strong></p><p>Apply box center notation to individual spatial dimensions while specifying custom values for others:</p><pre><code class="language-julia hljs"># Mixed center specification: box center for x,z; custom value for y
proj_z = projection(gas, :sd, :Msol_pc2,
                    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
                    center=[:bc, 24., :bc],  # [x_center, y_center, z_center]
                    range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:50.274

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 1708
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
</code></pre><h3 id="Multi-Quantity-Projections"><a class="docs-heading-anchor" href="#Multi-Quantity-Projections">Multi-Quantity Projections</a><a id="Multi-Quantity-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-Quantity-Projections" title="Permalink"></a></h3><h4 id="Single-Quantity-Arrays"><a class="docs-heading-anchor" href="#Single-Quantity-Arrays">Single Quantity Arrays</a><a id="Single-Quantity-Arrays-1"></a><a class="docs-heading-anchor-permalink" href="#Single-Quantity-Arrays" title="Permalink"></a></h4><p>Efficiently compute multiple projections in a single function call by passing arrays of quantities and units. This approach optimizes performance and ensures consistent spatial sampling across all requested variables.</p><p><strong>Syntax Requirements:</strong></p><ul><li><strong>Variables</strong>: Array format <code>[:var1, :var2, ...]</code> for multiple quantities</li><li><strong>Units</strong>: Plural keyword <code>units=</code> (not <code>unit=</code>) for array specification</li><li><strong>Consistency</strong>: Each variable requires corresponding unit specification</li></ul><pre><code class="language-julia hljs"># Single quantity in array format (demonstrates array syntax)
proj1_x = projection(gas, [:sd],                # Single variable in array
                     units=[:Msol_pc2],         # Corresponding unit array
                     direction=:x,              # X-direction projection
                     xrange=[-10.,10.],
                     yrange=[-10.,10.],
                     zrange=[-2.,2.],
                     center=[24.,24.,24.],      # Custom center coordinates
                     range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:52.746

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 342
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
</code></pre><h4 id="Multiple-Quantities-with-Different-Units"><a class="docs-heading-anchor" href="#Multiple-Quantities-with-Different-Units">Multiple Quantities with Different Units</a><a id="Multiple-Quantities-with-Different-Units-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-Quantities-with-Different-Units" title="Permalink"></a></h4><p>Combine different physical quantities in a single projection call, each with appropriate units:</p><pre><code class="language-julia hljs"># Multiple quantities with different units
proj1_z = projection(gas, [:sd, :vx],           # Surface density + x-velocity
                     units=[:Msol_pc2, :km_s],  # Different units for each
                     direction=:x,              # X-direction view
                     xrange=[-10.,10.],
                     yrange=[-10.,10.],
                     zrange=[-2.,2.],
                     center=[24.,24.,24.],
                     range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:54.338

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:sd, :vx)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 342
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 2 (sd, vx)
Processing mode: Variable-based parallel (2 threads)
</code></pre><h4 id="Positional-Argument-Syntax"><a class="docs-heading-anchor" href="#Positional-Argument-Syntax">Positional Argument Syntax</a><a id="Positional-Argument-Syntax-1"></a><a class="docs-heading-anchor-permalink" href="#Positional-Argument-Syntax" title="Permalink"></a></h4><p>Streamline function calls by using positional arguments in the correct order: <code>dataobject</code>, <code>variables</code>, <code>units</code>:</p><pre><code class="language-julia hljs"># Positional arguments: data, variables, units (keywords follow)
proj1_z = projection(gas, [:sd, :vx], [:Msol_pc2, :km_s],  # Required positional args
                     direction=:x,                          # Optional keywords
                     xrange=[-10.,10.],
                     yrange=[-10.,10.],
                     zrange=[-2.,2.],
                     center=[24.,24.,24.],
                     range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:56.206

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:sd, :vx)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 342
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 2 (sd, vx)
Processing mode: Variable-based parallel (2 threads)
</code></pre><h4 id="Uniform-Units-for-Multiple-Quantities"><a class="docs-heading-anchor" href="#Uniform-Units-for-Multiple-Quantities">Uniform Units for Multiple Quantities</a><a id="Uniform-Units-for-Multiple-Quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Uniform-Units-for-Multiple-Quantities" title="Permalink"></a></h4><p>When all quantities share the same unit, use single unit specification rather than array format:</p><pre><code class="language-julia hljs"># All velocity components with uniform units
projvel_z = projection(gas, [:vx, :vy, :vz],    # Velocity components
                       :km_s,                    # Single unit for all
                       xrange=[-10.,10.],
                       yrange=[-10.,10.],
                       zrange=[-2.,2.],
                       center=[24.,24.,24.],
                       range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:58:57.869

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:vx, :vy, :vz, :sd)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 1708
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 4 (sd, vx, vy, vz)
Processing mode: Variable-based parallel (4 threads)
</code></pre><h2 id="Projection-Output-Structure"><a class="docs-heading-anchor" href="#Projection-Output-Structure">Projection Output Structure</a><a id="Projection-Output-Structure-1"></a><a class="docs-heading-anchor-permalink" href="#Projection-Output-Structure" title="Permalink"></a></h2><h3 id="Data-Organization-and-Access"><a class="docs-heading-anchor" href="#Data-Organization-and-Access">Data Organization and Access</a><a id="Data-Organization-and-Access-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Organization-and-Access" title="Permalink"></a></h3><p>Projection results are stored in a structured object containing 2D maps, metadata, and spatial information. Understanding this organization enables efficient data access and further analysis.</p><h4 id="Object-Properties"><a class="docs-heading-anchor" href="#Object-Properties">Object Properties</a><a id="Object-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Object-Properties" title="Permalink"></a></h4><p>Examine the structure of projection output objects:</p><pre><code class="language-julia hljs"># List all available fields in the projection object
propertynames(proj1_z)</code></pre><pre><code class="nohighlight hljs">(:maps, :maps_unit, :maps_lmax, :maps_weight, :maps_mode, :lmax_projected, :lmin, :lmax, :ranges, :extent, :cextent, :ratio, :effres, :pixsize, :boxlen, :smallr, :smallc, :scale, :info)</code></pre><h4 id="Projection-Maps-Dictionary"><a class="docs-heading-anchor" href="#Projection-Maps-Dictionary">Projection Maps Dictionary</a><a id="Projection-Maps-Dictionary-1"></a><a class="docs-heading-anchor-permalink" href="#Projection-Maps-Dictionary" title="Permalink"></a></h4><p>The main results are stored in a dictionary structure where each key corresponds to a projected quantity:</p><pre><code class="language-julia hljs"># Access the maps dictionary containing all projected quantities
proj1_z.maps</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 2 entries:
  :sd =&gt; [2.41447 2.41447 … 3.05972 3.05972; 2.41447 2.41447 … 3.05972 3.05972;…
  :vx =&gt; [48.3311 48.3311 … 35.0161 35.0161; 48.3311 48.3311 … 35.0161 35.0161;…</code></pre><p>The maps can be accessed by giving the name of the dictionary:</p><pre><code class="language-julia hljs">proj1_z.maps[:sd]</code></pre><pre><code class="nohighlight hljs">1708×342 Matrix{Float64}:
 2.41447  2.41447  2.41447  2.41447  …  3.05972  3.05972  3.05972  3.05972
 2.41447  2.41447  2.41447  2.41447     3.05972  3.05972  3.05972  3.05972
 2.41447  2.41447  2.41447  2.41447     3.05972  3.05972  3.05972  3.05972
 2.41447  2.41447  2.41447  2.41447     3.05972  3.05972  3.05972  3.05972
 2.41447  2.41447  2.41447  2.41447     3.05972  3.05972  3.05972  3.05972
 2.4225   2.4225   2.4225   2.4225   …  3.04624  3.04624  3.04624  3.04624
 2.42659  2.42659  2.42659  2.42659     3.03937  3.03937  3.03937  3.03937
 2.42659  2.42659  2.42659  2.42659     3.03937  3.03937  3.03937  3.03937
 2.42659  2.42659  2.42659  2.42659     3.03937  3.03937  3.03937  3.03937
 2.42659  2.42659  2.42659  2.42659     3.03937  3.03937  3.03937  3.03937
 2.42659  2.42659  2.42659  2.42659  …  3.03937  3.03937  3.03937  3.03937
 2.42659  2.42659  2.42659  2.42659     3.03937  3.03937  3.03937  3.03937
 2.42659  2.42659  2.42659  2.42659     3.03937  3.03937  3.03937  3.03937
 ⋮                                   ⋱                    ⋮
 5.42462  5.42462  5.42462  5.42462     2.45112  2.45112  2.45112  2.45112
 5.42462  5.42462  5.42462  5.42462     2.45112  2.45112  2.45112  2.45112
 5.42462  5.42462  5.42462  5.42462     2.45112  2.45112  2.45112  2.45112
 5.42462  5.42462  5.42462  5.42462     2.45112  2.45112  2.45112  2.45112
 5.42462  5.42462  5.42462  5.42462  …  2.45112  2.45112  2.45112  2.45112
 5.42462  5.42462  5.42462  5.42462     2.45112  2.45112  2.45112  2.45112
 5.50853  5.50853  5.50853  5.50853     2.44314  2.44314  2.44314  2.44314
 5.67323  5.67323  5.67323  5.67323     2.42747  2.42747  2.42747  2.42747
 5.67323  5.67323  5.67323  5.67323     2.42747  2.42747  2.42747  2.42747
 5.67323  5.67323  5.67323  5.67323  …  2.42747  2.42747  2.42747  2.42747
 5.67323  5.67323  5.67323  5.67323     2.42747  2.42747  2.42747  2.42747
 5.67323  5.67323  5.67323  5.67323     2.42747  2.42747  2.42747  2.42747</code></pre><p>The units of the maps are stored in:</p><pre><code class="language-julia hljs">proj1_z.maps_unit</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 2 entries:
  :sd =&gt; :Msol_pc2
  :vx =&gt; :km_s</code></pre><p>Projections on a different grid size (see subject below):</p><pre><code class="language-julia hljs">proj1_z.maps_lmax</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering}()</code></pre><p>The following fields are helpful for further calculations or plots.</p><pre><code class="language-julia hljs">proj1_z.ranges # normalized to the domain=[0:1]</code></pre><pre><code class="nohighlight hljs">6-element Vector{Float64}:
 0.29166666666647767
 0.7083333333328743
 0.29166666666647767
 0.7083333333328743
 0.4583333333330363
 0.5416666666663156</code></pre><pre><code class="language-julia hljs">proj1_z.extent # ranges in code units</code></pre><pre><code class="nohighlight hljs">4-element Vector{Float64}:
 13.9921875
 34.0078125
 21.99609375
 26.00390625</code></pre><pre><code class="language-julia hljs">proj1_z.cextent # ranges in code units relative to a given center (by default: box center)</code></pre><pre><code class="nohighlight hljs">4-element Vector{Float64}:
 -10.007812500015556
  10.007812499984444
  -2.0039062500155556
   2.0039062499844444</code></pre><pre><code class="language-julia hljs">proj1_z.ratio # the ratio between the two ranges</code></pre><pre><code class="nohighlight hljs">4.994152046783626</code></pre><h2 id="Visualization-and-Plotting"><a class="docs-heading-anchor" href="#Visualization-and-Plotting">Visualization and Plotting</a><a id="Visualization-and-Plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization-and-Plotting" title="Permalink"></a></h2><h3 id="PyPlot-Integration"><a class="docs-heading-anchor" href="#PyPlot-Integration">PyPlot Integration</a><a id="PyPlot-Integration-1"></a><a class="docs-heading-anchor-permalink" href="#PyPlot-Integration" title="Permalink"></a></h3><p>MERA.jl seamlessly integrates with Python plotting libraries, providing access to sophisticated visualization capabilities through PyPlot and matplotlib.</p><pre><code class="language-julia hljs"># Prepare projections for visualization
# Z-direction: top-down view of galactic disk
proj_z = projection(gas, :sd, :Msol_pc2,
                    zrange=[-2.,2.],          # 4 kpc integration depth
                    center=[:boxcenter],      # Center on simulation box
                    range_unit=:kpc,
                    verbose=false)

# X-direction: edge-on view showing vertical structure
proj_x = projection(gas, :sd, :Msol_pc2,
                    zrange=[-2.,2.],          # Same integration depth
                    center=[:boxcenter],
                    range_unit=:kpc,
                    verbose=false,
                    direction=:x);</code></pre><pre><code class="nohighlight hljs">Progress: 100%|█████████████████████████████████████████| Time: 0:00:03
Progress: 100%|█████████████████████████████████████████| Time: 0:00:03
</code></pre><h4 id="matplotlib-Configuration"><a class="docs-heading-anchor" href="#matplotlib-Configuration">matplotlib Configuration</a><a id="matplotlib-Configuration-1"></a><a class="docs-heading-anchor-permalink" href="#matplotlib-Configuration" title="Permalink"></a></h4><p>Configure plotting libraries and color schemes for professional scientific visualization:</p><pre><code class="language-julia hljs">using PyPlot
using ColorSchemes

# Configure scientific color schemes
cmap3 = ColorMap(ColorSchemes.Blues.colors)           # Sequential blue colormap
cmap = ColorMap(ColorSchemes.lajolla.colors)          # Perceptually uniform colormap
cmap2 = ColorMap(reverse(ColorSchemes.romaO.colors))  # Diverging colormap

# Note: lajolla colormap from http://www.fabiocrameri.ch/colourmaps.php
# These colormaps are designed for scientific visualization</code></pre><pre><code class="nohighlight hljs">ColorMap &quot;cm_8875344879699870350&quot;</code></pre><pre><code class="language-julia hljs"># Create professional dual-panel figure
figure(figsize=(10, 3.5))

# Left panel: Face-on view (z-direction projection)
subplot(1,2,1)
im = imshow(log10.(permutedims(proj_z.maps[:sd])),  # Transpose for correct orientation
           cmap=cmap,                               # Apply scientific colormap
           aspect=proj_z.ratio,                     # Maintain aspect ratio
           origin=&quot;lower&quot;,                          # Origin at bottom-left
           extent=proj_z.cextent,                   # Physical coordinate extent
           vmin=0, vmax=3)                          # Set color scale limits
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;)

# Right panel: Edge-on view (x-direction projection)
subplot(1,2,2)
im = imshow(log10.(permutedims(proj_x.maps[:sd])),
           cmap=cmap,
           origin=&quot;lower&quot;,
           extent=proj_x.cextent,
           vmin=0, vmax=3)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im,
             label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;,
             orientation=&quot;horizontal&quot;,
             pad=0.2)</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_47_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><pre><code class="nohighlight hljs">PyObject &lt;matplotlib.colorbar.Colorbar object at 0x34858da30&gt;</code></pre><pre><code class="language-julia hljs">proj_z = projection(gas, :sd, :Msol_pc2,
                    xrange=[-5,0],
                    yrange=[-5,0],
                    zrange=[-2.,2.], center=[:bc], range_unit=:kpc,
                    verbose=false)
proj_x = projection(gas, :sd, :Msol_pc2,
                    xrange=[-5,0],
                    yrange=[-5,0],
                    zrange=[-2.,2.], center=[24.,24.,24.], range_unit=:kpc,
                    verbose=false,
                    direction = :x);</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:sd])), cmap=cmap, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent) #, vmin=0, vmax=3)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:sd])), cmap=cmap, origin=&quot;lower&quot;, aspect=proj_x.ratio, extent=proj_x.cextent) #, vmin=0, vmax=3)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;)</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_49_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><pre><code class="nohighlight hljs">PyObject &lt;matplotlib.colorbar.Colorbar object at 0x3485e54c0&gt;</code></pre><p>Project a specific spatial range and plot the axes of the map relative to the box-center (given by keyword: data_center):</p><h2 id="Advanced-Kinematic-Analysis"><a class="docs-heading-anchor" href="#Advanced-Kinematic-Analysis">Advanced Kinematic Analysis</a><a id="Advanced-Kinematic-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Kinematic-Analysis" title="Permalink"></a></h2><h3 id="Derived-Velocity-and-Dispersion-Fields"><a class="docs-heading-anchor" href="#Derived-Velocity-and-Dispersion-Fields">Derived Velocity and Dispersion Fields</a><a id="Derived-Velocity-and-Dispersion-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Derived-Velocity-and-Dispersion-Fields" title="Permalink"></a></h3><p>MERA.jl computes sophisticated kinematic quantities from fundamental velocity data, enabling detailed analysis of gas dynamics and turbulence properties.</p><h4 id="Cartesian-Coordinate-Velocities"><a class="docs-heading-anchor" href="#Cartesian-Coordinate-Velocities">Cartesian Coordinate Velocities</a><a id="Cartesian-Coordinate-Velocities-1"></a><a class="docs-heading-anchor-permalink" href="#Cartesian-Coordinate-Velocities" title="Permalink"></a></h4><p>Derive kinematic properties from fundamental velocity fields:</p><p><strong>Available Quantities:</strong></p><ul><li><strong><code>:v</code></strong>: Total velocity magnitude |<strong>v</strong>| = √(vₓ² + vᵧ² + vᵤ²)</li><li><strong><code>:σ</code></strong>: Total velocity dispersion (3D random motion)</li><li><strong><code>:σx, :σy, :σz</code></strong>: Directional velocity dispersions along coordinate axes</li></ul><p><strong>Technical Implementation:</strong></p><ul><li>Mass-weighted projections by default</li><li>Velocity dispersion: σₓ = √(⟨vₓ²⟩ - ⟨vₓ⟩²) following standard statistical definition</li><li>Unicode symbols supported: use <code>\sigma + tab</code> for <strong>σ</strong> in Julia</li></ul><pre><code class="language-julia hljs"># Project comprehensive kinematic quantities
proj_z = projection(gas, [:v, :σ, :σx, :σy, :σz],  # Velocity magnitude and dispersions
                    :km_s,                          # Uniform velocity units
                    xrange=[-10.,10.],
                    yrange=[-10.,10.],
                    zrange=[-2.,2.],
                    center=[24.,24.,24.],
                    range_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:59:21.635

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:v, :σ, :σx, :σy, :σz, :vx, :vx2, :vy, :vy2, :vz, :vz2, :v2, :sd)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 1708
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 9 (sd, v, v2, vx, vx2, vy, vy2, vz, vz2)
Processing mode: Variable-based parallel (8 threads)
</code></pre><h4 id="Velocity-Dispersion-Implementation"><a class="docs-heading-anchor" href="#Velocity-Dispersion-Implementation">Velocity Dispersion Implementation</a><a id="Velocity-Dispersion-Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Velocity-Dispersion-Implementation" title="Permalink"></a></h4><p>Additional intermediate maps are automatically created for velocity dispersion calculations:</p><p><strong>Mathematical Formula:</strong> σₓ = √(⟨vₓ²⟩ - ⟨vₓ⟩²)</p><p>This requires computation of both first and second moments of the velocity distribution, stored as separate map components.</p><pre><code class="language-julia hljs">proj_z.maps</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 13 entries:
  :sd  =&gt; [0.000524564 0.000524564 … 0.000462735 0.000462735; 0.000524564 0.000…
  :v   =&gt; [87.2263 87.2263 … 74.2532 74.2532; 87.2263 87.2263 … 74.2532 74.2532…
  :v2  =&gt; [1.96323 1.96323 … 1.55066 1.55066; 1.96323 1.96323 … 1.55066 1.55066…
  :vx  =&gt; [0.956079 0.956079 … -0.560013 -0.560013; 0.956079 0.956079 … -0.5600…
  :vx2 =&gt; [0.97878 0.97878 … 0.890713 0.890713; 0.97878 0.97878 … 0.890713 0.89…
  :vy  =&gt; [0.356529 0.356529 … -0.0411814 -0.0411814; 0.356529 0.356529 … -0.04…
  :vy2 =&gt; [0.264853 0.264853 … 0.152368 0.152368; 0.264853 0.264853 … 0.152368 …
  :vz  =&gt; [-0.799307 -0.799307 … -0.296515 -0.296515; -0.799307 -0.799307 … -0.…
  :vz2 =&gt; [0.719601 0.719601 … 0.50758 0.50758; 0.719601 0.719601 … 0.50758 0.5…
  :σ   =&gt; [28.874 28.874 … 33.9777 33.9777; 28.874 28.874 … 33.9777 33.9777; … …
  :σx  =&gt; [16.6789 16.6789 … 49.8155 49.8155; 16.6789 16.6789 … 49.8155 49.8155…
  :σy  =&gt; [24.3371 24.3371 … 25.4541 25.4541; 24.3371 24.3371 … 25.4541 25.4541…
  :σz  =&gt; [18.6295 18.6295 … 42.4804 42.4804; 18.6295 18.6295 … 42.4804 42.4804…</code></pre><pre><code class="language-julia hljs">proj_z.maps_unit</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 13 entries:
  :sd  =&gt; :standard
  :v   =&gt; :km_s
  :v2  =&gt; :standard
  :vx  =&gt; :standard
  :vx2 =&gt; :standard
  :vy  =&gt; :standard
  :vy2 =&gt; :standard
  :vz  =&gt; :standard
  :vz2 =&gt; :standard
  :σ   =&gt; :km_s
  :σx  =&gt; :km_s
  :σy  =&gt; :km_s
  :σz  =&gt; :km_s</code></pre><pre><code class="language-julia hljs">usedmemory(proj_z);</code></pre><pre><code class="nohighlight hljs">Memory used: 311.9 MB
</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 5.5))

subplot(2, 3, 1)
title(&quot;v [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:v])  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 2)
title(&quot;σ [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σ])  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 4)
title(&quot;σx [km/s]&quot;)
imshow( (permutedims(proj_z.maps[:σx])   ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 5)
title(&quot;σy [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σy]) , cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(2, 3, 6)
title(&quot;σz [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σz]) , cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_59_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x550 with 10 Axes&gt;)</code></pre><h4 id="Cylindrical-Coordinate-System"><a class="docs-heading-anchor" href="#Cylindrical-Coordinate-System">Cylindrical Coordinate System</a><a id="Cylindrical-Coordinate-System-1"></a><a class="docs-heading-anchor-permalink" href="#Cylindrical-Coordinate-System" title="Permalink"></a></h4><h5 id="Face-on-Disk-Analysis-(z-direction)"><a class="docs-heading-anchor" href="#Face-on-Disk-Analysis-(z-direction)">Face-on Disk Analysis (z-direction)</a><a id="Face-on-Disk-Analysis-(z-direction)-1"></a><a class="docs-heading-anchor-permalink" href="#Face-on-Disk-Analysis-(z-direction)" title="Permalink"></a></h5><p>For galactic disk studies, cylindrical coordinates provide natural physical interpretation. The coordinate transformation uses a specified center point for radius and azimuthal angle calculations.</p><pre><code class="language-julia hljs"># Comprehensive cylindrical coordinate analysis
proj_z = projection(gas,
    # Cartesian quantities
    [:v, :σ, :σx, :σy,
    # Cylindrical coordinate quantities
     :ϕ, :r_cylinder, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
    # Corresponding units
    units=[:km_s, :km_s, :km_s, :km_s,
           :standard, :kpc, :km_s, :km_s, :km_s, :km_s],
    # Spatial selection
    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
    center=[:boxcenter], range_unit=:kpc,
    # Coordinate transformation center
    data_center=[24.,24.,24.], data_center_unit=:kpc);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:59:29.082

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:v, :σ, :σx, :σy, :ϕ, :r_cylinder, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder, :vx, :vx2, :vy, :vy2, :v2, :vr_cylinder2, :vϕ_cylinder2, :sd)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 1708 x 1708
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 11 (sd, v, v2, vr_cylinder, vr_cylinder2, vx, vx2, vy, vy2, vϕ_cylinder, vϕ_cylinder2)
Processing mode: Variable-based parallel (8 threads)
</code></pre><pre><code class="language-julia hljs">proj_z.maps</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 18 entries:
  :r_cylinder   =&gt; [14.1256 14.1173 … 14.1366 14.1449; 14.1173 14.109 … 14.1283…
  :sd           =&gt; [0.000524564 0.000524564 … 0.000462735 0.000462735; 0.000524…
  :v            =&gt; [87.2263 87.2263 … 74.2532 74.2532; 87.2263 87.2263 … 74.253…
  :v2           =&gt; [1.96323 1.96323 … 1.55066 1.55066; 1.96323 1.96323 … 1.5506…
  :vr_cylinder  =&gt; [-60.864 -60.864 … 23.8666 23.8666; -60.864 -60.864 … 23.866…
  :vr_cylinder2 =&gt; [1.05049 1.05049 … 0.620751 0.620751; 1.05049 1.05049 … 0.62…
  :vx           =&gt; [0.956079 0.956079 … -0.560013 -0.560013; 0.956079 0.956079 …
  :vx2          =&gt; [0.97878 0.97878 … 0.890713 0.890713; 0.97878 0.97878 … 0.89…
  :vy           =&gt; [0.356529 0.356529 … -0.0411814 -0.0411814; 0.356529 0.35652…
  :vy2          =&gt; [0.264853 0.264853 … 0.152368 0.152368; 0.264853 0.264853 … …
  :vϕ_cylinder  =&gt; [27.8004 27.8004 … 27.9518 27.9518; 27.8004 27.8004 … 27.951…
  :vϕ_cylinder2 =&gt; [0.193141 0.193141 … 0.42233 0.42233; 0.193141 0.193141 … 0.…
  :σ            =&gt; [28.874 28.874 … 33.9777 33.9777; 28.874 28.874 … 33.9777 33…
  :σr_cylinder  =&gt; [28.5099 28.5099 … 45.8223 45.8223; 28.5099 28.5099 … 45.822…
  :σx           =&gt; [16.6789 16.6789 … 49.8155 49.8155; 16.6789 16.6789 … 49.815…
  :σy           =&gt; [24.3371 24.3371 … 25.4541 25.4541; 24.3371 24.3371 … 25.454…
  :σϕ_cylinder  =&gt; [7.59396 7.59396 … 32.1677 32.1677; 7.59396 7.59396 … 32.167…
  :ϕ            =&gt; [3.92699 3.9264 … 2.35541 2.35483; 3.92758 3.92699 … 2.35483…</code></pre><pre><code class="language-julia hljs">proj_z.maps_unit</code></pre><pre><code class="nohighlight hljs">DataStructures.SortedDict{Any, Any, Base.Order.ForwardOrdering} with 18 entries:
  :r_cylinder   =&gt; :kpc
  :sd           =&gt; :standard
  :v            =&gt; :km_s
  :v2           =&gt; :standard
  :vr_cylinder  =&gt; :km_s
  :vr_cylinder2 =&gt; :standard
  :vx           =&gt; :standard
  :vx2          =&gt; :standard
  :vy           =&gt; :standard
  :vy2          =&gt; :standard
  :vϕ_cylinder  =&gt; :km_s
  :vϕ_cylinder2 =&gt; :standard
  :σ            =&gt; :km_s
  :σr_cylinder  =&gt; :km_s
  :σx           =&gt; :km_s
  :σy           =&gt; :km_s
  :σϕ_cylinder  =&gt; :km_s
  :ϕ            =&gt; :radian</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 8.5))

subplot(3, 3, 1)
title(&quot;Radius [kpc]&quot;)
imshow( permutedims(proj_z.maps[:r_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 2)
title(&quot;vr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vr_cylinder] ), cmap=&quot;seismic&quot;, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-20.,vmax=20.)
colorbar()

subplot(3, 3, 3)
title(&quot;vϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vϕ_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 4)
title(&quot;ϕ-angle &quot;)
imshow( permutedims(proj_z.maps[:ϕ]) , cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 5)
title(&quot;σr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σr_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 6)
title(&quot;σϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σϕ_cylinder] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 7)
title(&quot;σ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σ]) , cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 8)
title(&quot;σx [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σx] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 9)
title(&quot;σy [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σy] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_64_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x850 with 18 Axes&gt;)</code></pre><h3 id="Performance-Tips-for-Kinematic-Analysis"><a class="docs-heading-anchor" href="#Performance-Tips-for-Kinematic-Analysis">Performance Tips for Kinematic Analysis</a><a id="Performance-Tips-for-Kinematic-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Performance-Tips-for-Kinematic-Analysis" title="Permalink"></a></h3><h4 id="Memory-Optimization"><a class="docs-heading-anchor" href="#Memory-Optimization">Memory Optimization</a><a id="Memory-Optimization-1"></a><a class="docs-heading-anchor-permalink" href="#Memory-Optimization" title="Permalink"></a></h4><p>Kinematic projections can be memory-intensive due to multiple intermediate calculations:</p><pre><code class="language-julia hljs"># Memory-efficient approach: Process quantities separately
proj_velocity = projection(gas, [:vx, :vy, :vz], :km_s, lmax=6)
proj_dispersion = projection(gas, [:σx, :σy, :σz], :km_s, lmax=6)

# Check memory usage
usedmemory(proj_velocity)
usedmemory(proj_dispersion)</code></pre><h4 id="Computational-Efficiency"><a class="docs-heading-anchor" href="#Computational-Efficiency">Computational Efficiency</a><a id="Computational-Efficiency-1"></a><a class="docs-heading-anchor-permalink" href="#Computational-Efficiency" title="Permalink"></a></h4><pre><code class="language-julia hljs"># For exploratory analysis: use coarser resolution
proj_explore = projection(gas, [:v, :σ], :km_s, lmax=6)

# For publication: increase resolution selectively
proj_final = projection(gas, [:v, :σ], :km_s,
                       xrange=[-5,5], yrange=[-5,5],  # Focus on core
                       lmax=10)                       # High resolution</code></pre><h4 id="Threading-Considerations"><a class="docs-heading-anchor" href="#Threading-Considerations">Threading Considerations</a><a id="Threading-Considerations-1"></a><a class="docs-heading-anchor-permalink" href="#Threading-Considerations" title="Permalink"></a></h4><pre><code class="language-julia hljs"># Monitor threading performance for optimization
proj = projection(gas, [:v, :σ, :σx, :σy, :σz], :km_s,
                 verbose_threads=true)  # Shows parallel efficiency</code></pre><h2 id="Grid-Resolution-Control"><a class="docs-heading-anchor" href="#Grid-Resolution-Control">Grid Resolution Control</a><a id="Grid-Resolution-Control-1"></a><a class="docs-heading-anchor-permalink" href="#Grid-Resolution-Control" title="Permalink"></a></h2><h3 id="Adaptive-Resolution-Selection"><a class="docs-heading-anchor" href="#Adaptive-Resolution-Selection">Adaptive Resolution Selection</a><a id="Adaptive-Resolution-Selection-1"></a><a class="docs-heading-anchor-permalink" href="#Adaptive-Resolution-Selection" title="Permalink"></a></h3><p>Control projection grid resolution to balance computational efficiency with spatial detail. MERA.jl offers multiple resolution specification methods to suit different analysis requirements.</p><h4 id="Refinement-Level-Control-(lmax)"><a class="docs-heading-anchor" href="#Refinement-Level-Control-(lmax)">Refinement Level Control (<code>lmax</code>)</a><a id="Refinement-Level-Control-(lmax)-1"></a><a class="docs-heading-anchor-permalink" href="#Refinement-Level-Control-(lmax)" title="Permalink"></a></h4><p>The <code>lmax</code> parameter controls grid resolution through AMR level specification:</p><p><strong>Key Features:</strong></p><ul><li><strong>Default Behavior</strong>: Uses maximum loaded refinement level for highest available resolution</li><li><strong>Coarser Grids</strong>: Lower <code>lmax</code> values reduce computational cost and memory usage</li><li><strong>Independence</strong>: Can exceed simulation&#39;s maximum level for interpolated higher resolution</li><li><strong>Grid Scaling</strong>: Resolution = 2^lmax grid cells along each dimension</li></ul><pre><code class="language-julia hljs"># Project on coarser grid (level 6) for faster computation
proj_z = projection(gas,
    [:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
    :km_s,
    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
    center=[:boxcenter], range_unit=:kpc,
    lmax=6);  # 2^6 = 64 grid cells per dimension</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:59:43.605

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder, :vx, :vx2, :vy, :vy2, :vz, :vz2, :v2, :vr_cylinder2, :vϕ_cylinder2, :sd)
Weighting      = :mass

Effective resolution: 64^2
Map size: 28 x 28
Pixel size: 750.0 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 13 (sd, v, v2, vr_cylinder, vr_cylinder2, vx, vx2, vy, vy2, vz, vz2, vϕ_cylinder, vϕ_cylinder2)
Processing mode: Variable-based parallel (8 threads)
</code></pre><pre><code class="language-julia hljs"># this corresponds to an effective resolution of:
proj_z.effres</code></pre><pre><code class="nohighlight hljs">64</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 8.5))

subplot(3, 3, 1)
title(&quot;v [km/s]&quot;)
imshow( permutedims(proj_z.maps[:v]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 2)
title(&quot;vr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vr_cylinder] ), cmap=&quot;seismic&quot;, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-20.,vmax=20.)
colorbar()

subplot(3, 3, 3)
title(&quot;vϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vϕ_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 4)
title(&quot;σz [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σz] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 5)
title(&quot;σr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σr_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 6)
title(&quot;σϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σϕ_cylinder] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 7)
title(&quot;σ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σ]) , cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 8)
title(&quot;σx [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σx]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 9)
title(&quot;σy [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σy] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_70_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x850 with 18 Axes&gt;)</code></pre><h4 id="Direct-Resolution-Specification-(res)"><a class="docs-heading-anchor" href="#Direct-Resolution-Specification-(res)">Direct Resolution Specification (<code>res</code>)</a><a id="Direct-Resolution-Specification-(res)-1"></a><a class="docs-heading-anchor-permalink" href="#Direct-Resolution-Specification-(res)" title="Permalink"></a></h4><p>Specify absolute grid resolution independent of AMR levels:</p><pre><code class="language-julia hljs"># Direct resolution specification: 100x100 grid
proj_z = projection(gas,
    [:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
    :km_s,
    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
    center=[:boxcenter], range_unit=:kpc,
    res=100);  # 100x100 pixel output grid</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T14:59:52.220

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder, :vx, :vx2, :vy, :vy2, :vz, :vz2, :v2, :vr_cylinder2, :vϕ_cylinder2, :sd)
Weighting      = :mass

Effective resolution: 100^2
Map size: 42 x 42
Pixel size: 480.0 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 13 (sd, v, v2, vr_cylinder, vr_cylinder2, vx, vx2, vy, vy2, vz, vz2, vϕ_cylinder, vϕ_cylinder2)
Processing mode: Variable-based parallel (8 threads)
</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 8.5))

subplot(3, 3, 1)
title(&quot;v [km/s]&quot;)
imshow( permutedims(proj_z.maps[:v]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 2)
title(&quot;vr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vr_cylinder] ), cmap=&quot;seismic&quot;, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-20.,vmax=20.)
colorbar()

subplot(3, 3, 3)
title(&quot;vϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vϕ_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 4)
title(&quot;σz [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σz] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 5)
title(&quot;σr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σr_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 6)
title(&quot;σϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σϕ_cylinder] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 7)
title(&quot;σ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σ]) , cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 8)
title(&quot;σx [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σx]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 9)
title(&quot;σy [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σy] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_73_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x850 with 18 Axes&gt;)</code></pre><h4 id="Physical-Pixel-Size-Control-(pxsize)"><a class="docs-heading-anchor" href="#Physical-Pixel-Size-Control-(pxsize)">Physical Pixel Size Control (<code>pxsize</code>)</a><a id="Physical-Pixel-Size-Control-(pxsize)-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Pixel-Size-Control-(pxsize)" title="Permalink"></a></h4><p>Specify resolution through physical pixel dimensions for direct scale control:</p><pre><code class="language-julia hljs"># Physical pixel size specification
proj_z = projection(gas,
    [:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder],
    :km_s,
    xrange=[-10.,10.], yrange=[-10.,10.], zrange=[-2.,2.],
    center=[:boxcenter], range_unit=:kpc,
    pxsize=[1000., :pc],      # 1000 pc per pixel (1 kpc/pixel)
    verbose_threads=true);     # Show threading information</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:00:00.507

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
ymin::ymax: 0.2916667 :: 0.7083333  	==&gt; 14.0 [kpc] :: 34.0 [kpc]
zmin::zmax: 0.4583333 :: 0.5416667  	==&gt; 22.0 [kpc] :: 26.0 [kpc]

Selected var(s)=(:v, :σ, :σx, :σy, :σz, :vr_cylinder, :vϕ_cylinder, :σr_cylinder, :σϕ_cylinder, :vx, :vx2, :vy, :vy2, :vz, :vz2, :v2, :vr_cylinder2, :vϕ_cylinder2, :sd)
Weighting      = :mass

Effective resolution: 49^2
Map size: 21 x 21
Pixel size: 979.592 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 13 (sd, v, v2, vr_cylinder, vr_cylinder2, vx, vx2, vy, vy2, vz, vz2, vϕ_cylinder, vϕ_cylinder2)
Processing mode: Variable-based parallel (8 threads)
🚀 Variable-based parallel processing with 8 threads
   ├─ Variables: 13 across AMR levels 6 to 12
   ├─ Total cells: 18590638
   ├─ Cells per variable: 1430049
   └─ Expected efficiency: 85-95% (no combining overhead)
🚀 Using variable-based parallel processing
   Variables: 13 (sd, v, v2, vr_cylinder, vr_cylinder2, vx, vx2, vy, vy2, vz, vz2, vϕ_cylinder, vϕ_cylinder2)
   Processing levels 6 to 12
   🧵 Thread allocation: sd→T1, v→T2, v2→T3, vr_cylinder→T4, vr_cylinder2→T5, vx→T6, vx2→T7, vy→T8
✅ Variable-based parallel processing completed in 1.907s
   ⚡ No combining phase needed - direct variable assignment eliminates overhead!
   📊 Performance Metrics:
      ├─ Total operations: 241678294 (18590638 cells × 13 vars)
      ├─ Processing rate: 126761366 cells/second
      ├─ Parallel efficiency: 100.0% (target: 85-95%)
      ├─ Threads utilized: 8 / 8 available
      └─ Memory benefit: Direct allocation (no intermediate combining buffers)
</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 8.5))

subplot(3, 3, 1)
title(&quot;v [km/s]&quot;)
imshow( permutedims(proj_z.maps[:v]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 2)
title(&quot;vr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vr_cylinder] ), cmap=&quot;seismic&quot;, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-20.,vmax=20.)
colorbar()

subplot(3, 3, 3)
title(&quot;vϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:vϕ_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 4)
title(&quot;σz [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σz] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 5)
title(&quot;σr [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σr_cylinder]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 6)
title(&quot;σϕ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σϕ_cylinder] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 7)
title(&quot;σ [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σ]) , cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 8)
title(&quot;σx [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σx]  ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar()

subplot(3, 3, 9)
title(&quot;σy [km/s]&quot;)
imshow( permutedims(proj_z.maps[:σy] ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
colorbar();</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_76_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x850 with 18 Axes&gt;)</code></pre><h2 id="Thermal-Properties-Analysis"><a class="docs-heading-anchor" href="#Thermal-Properties-Analysis">Thermal Properties Analysis</a><a id="Thermal-Properties-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Thermal-Properties-Analysis" title="Permalink"></a></h2><h3 id="Sound-Speed-Projections"><a class="docs-heading-anchor" href="#Sound-Speed-Projections">Sound Speed Projections</a><a id="Sound-Speed-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Sound-Speed-Projections" title="Permalink"></a></h3><p>Sound speed calculations utilize the adiabatic index γ from hydro files:</p><p><strong>Physical Formula:</strong> cs = √(γ P/ρ) = √(γ kT/μmH)</p><p><strong>Implementation:</strong></p><ul><li>Adiabatic index loaded automatically from simulation data</li><li>Temperature and pressure derived from internal energy</li><li>Sound speed represents local gas thermal pressure support</li></ul><pre><code class="language-julia hljs"># Sound speed projections in multiple directions
proj_z = projection(gas, :cs, :km_s,           # Z-direction sound speed
                    zrange=[0.45,0.55],        # Thin central slice
                    xrange=[0.4, 0.6],
                    yrange=[0.4, 0.6])

proj_x = projection(gas, :cs, :km_s,           # X-direction sound speed
                    zrange=[0.45,0.55],        # Same spatial selection
                    xrange=[0.4, 0.6],
                    yrange=[0.4, 0.6],
                    direction=:x);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:00:07.588

domain:
xmin::xmax: 0.4 :: 0.6  	==&gt; 19.2 [kpc] :: 28.8 [kpc]
ymin::ymax: 0.4 :: 0.6  	==&gt; 19.2 [kpc] :: 28.8 [kpc]
zmin::zmax: 0.45 :: 0.55  	==&gt; 21.6 [kpc] :: 26.4 [kpc]

Selected var(s)=(:cs, :sd)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 820 x 820
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 2 (cs, sd)
Processing mode: Variable-based parallel (2 threads)
[Mera]: 2025-08-14T15:00:09.266

domain:
xmin::xmax: 0.4 :: 0.6  	==&gt; 19.2 [kpc] :: 28.8 [kpc]
ymin::ymax: 0.4 :: 0.6  	==&gt; 19.2 [kpc] :: 28.8 [kpc]
zmin::zmax: 0.45 :: 0.55  	==&gt; 21.6 [kpc] :: 26.4 [kpc]

Selected var(s)=(:cs, :sd)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 820 x 410
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 2 (cs, sd)
Processing mode: Variable-based parallel (2 threads)
</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))

subplot(1, 2, 1)
im = imshow( log10.(permutedims(proj_z.maps[:cs])   ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_z.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(c_s) \ [km \ s^{-1}]}&quot;)

subplot(1, 2, 2)
im = imshow( log10.(permutedims(proj_x.maps[:cs]) ), cmap=cmap2, origin=&quot;lower&quot;, extent=proj_x.cextent)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(c_s) \ [km \ s^{-1}]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_80_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><h4 id="Custom-Adiabatic-Index"><a class="docs-heading-anchor" href="#Custom-Adiabatic-Index">Custom Adiabatic Index</a><a id="Custom-Adiabatic-Index-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Adiabatic-Index" title="Permalink"></a></h4><p>Modify the adiabatic index for alternative equation of state calculations:</p><pre><code class="language-julia hljs">gas.info.gamma = 5/3  # Monatomic ideal gas
gas.info.gamma = 7/5  # Diatomic gas</code></pre><h4 id="Practical-Examples-for-Scientific-Analysis"><a class="docs-heading-anchor" href="#Practical-Examples-for-Scientific-Analysis">Practical Examples for Scientific Analysis</a><a id="Practical-Examples-for-Scientific-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Practical-Examples-for-Scientific-Analysis" title="Permalink"></a></h4><h5 id="Star-Formation-Rate-Surface-Density"><a class="docs-heading-anchor" href="#Star-Formation-Rate-Surface-Density">Star Formation Rate Surface Density</a><a id="Star-Formation-Rate-Surface-Density-1"></a><a class="docs-heading-anchor-permalink" href="#Star-Formation-Rate-Surface-Density" title="Permalink"></a></h5><pre><code class="language-julia hljs"># Identify dense, cold gas (star-forming regions)
sf_mask = (getvar(gas, :rho, :nH) .&gt; 100) .&amp;
          (getvar(gas, :Temperature, :K) .&lt; 1000)

sf_proj = projection(gas, :sd, :Msol_pc2, mask=sf_mask,
                    zrange=[-0.5, 0.5], center=[:boxcenter])</code></pre><h5 id="Pressure-Support-Analysis"><a class="docs-heading-anchor" href="#Pressure-Support-Analysis">Pressure Support Analysis</a><a id="Pressure-Support-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Pressure-Support-Analysis" title="Permalink"></a></h5><pre><code class="language-julia hljs"># Compare thermal vs turbulent pressure support
thermal_proj = projection(gas, :cs, :km_s)
turbulent_proj = projection(gas, :σ, :km_s)

# Thermal pressure ∝ cs²
# Turbulent pressure ∝ σ²</code></pre><h5 id="Rotation-Curve-Extraction"><a class="docs-heading-anchor" href="#Rotation-Curve-Extraction">Rotation Curve Extraction</a><a id="Rotation-Curve-Extraction-1"></a><a class="docs-heading-anchor-permalink" href="#Rotation-Curve-Extraction" title="Permalink"></a></h5><pre><code class="language-julia hljs"># Radial velocity profiles for rotation curves
rotation_proj = projection(gas, [:vr_cylinder, :vϕ_cylinder], [:km_s, :km_s],
                          zrange=[-1, 1],  # Thin disk
                          data_center=[:boxcenter])</code></pre><h2 id="Selective-Data-Analysis"><a class="docs-heading-anchor" href="#Selective-Data-Analysis">Selective Data Analysis</a><a id="Selective-Data-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Selective-Data-Analysis" title="Permalink"></a></h2><h3 id="Masked-Projections"><a class="docs-heading-anchor" href="#Masked-Projections">Masked Projections</a><a id="Masked-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Masked-Projections" title="Permalink"></a></h3><p>Apply physical selection criteria to isolate specific gas phases or conditions. Masking enables targeted analysis of phenomena like star formation regions, shocked gas, or specific temperature/density regimes.</p><pre><code class="language-julia hljs"># Create physical condition masks
# Select low-density gas (&lt; 1 particle per cm³)
mask_nH = getvar(gas, :rho, :nH) .&lt; .1     # Number density constraint

# Select ionized gas (&gt; 10⁴ K)
mask_T = getvar(gas, :Temperature, :K) .&gt; 1e4  # Temperature constraint

# Combine masks: hot AND low-density gas
mask_tot = mask_nH .* mask_T;</code></pre><h4 id="Apply-Masks-to-Projections"><a class="docs-heading-anchor" href="#Apply-Masks-to-Projections">Apply Masks to Projections</a><a id="Apply-Masks-to-Projections-1"></a><a class="docs-heading-anchor-permalink" href="#Apply-Masks-to-Projections" title="Permalink"></a></h4><p>Pass Boolean masks to projection functions to exclude unwanted data:</p><pre><code class="language-julia hljs"># Apply mask to projection: only cool, low-density gas
proj_z = projection(gas, :sd, :Msol_pc2,
                    zrange=[0.45,0.55],
                    mask=mask_tot)        # Apply combined mask

proj_x = projection(gas, :sd, :Msol_pc2,
                    zrange=[0.45,0.55],
                    mask=mask_tot,        # Same mask for consistency
                    direction=:x);</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:00:11.921

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.45 :: 0.55  	==&gt; 21.6 [kpc] :: 26.4 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 4096 x 4096
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

:mask provided by function

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
</code></pre><pre><code class="nohighlight hljs">Progress: 100%|█████████████████████████████████████████| Time: 0:00:02
</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:00:15.916

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.45 :: 0.55  	==&gt; 21.6 [kpc] :: 26.4 [kpc]

Selected var(s)=(:sd,)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 4096 x 410
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

:mask provided by function

Available threads: 8
Requested max_threads: 8
Variables: 1 (sd)
Processing mode: Sequential (single thread)
</code></pre><pre><code class="nohighlight hljs">Progress: 100%|█████████████████████████████████████████| Time: 0:00:02
</code></pre><pre><code class="language-julia hljs">figure(figsize=(10, 3.5))
subplot(1,2,1)
im = imshow( log10.( permutedims(proj_z.maps[:sd])), cmap=cmap, aspect=proj_z.ratio, origin=&quot;lower&quot;, extent=proj_z.cextent, vmin=-1, vmax=1)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;y [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;)

subplot(1,2,2)
im = imshow( log10.( permutedims(proj_x.maps[:sd])), cmap=cmap, origin=&quot;lower&quot;, extent=proj_x.cextent, vmin=0, vmax=1.5)
xlabel(&quot;x [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(\Sigma) \ [M_{\odot} pc^{-2}]}&quot;,orientation=&quot;horizontal&quot;, pad=0.2);
tight_layout()</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_88_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 4 Axes&gt;)</code></pre><h2 id="Weighting-and-Integration-Schemes"><a class="docs-heading-anchor" href="#Weighting-and-Integration-Schemes">Weighting and Integration Schemes</a><a id="Weighting-and-Integration-Schemes-1"></a><a class="docs-heading-anchor-permalink" href="#Weighting-and-Integration-Schemes" title="Permalink"></a></h2><h3 id="Alternative-Weighting-Methods"><a class="docs-heading-anchor" href="#Alternative-Weighting-Methods">Alternative Weighting Methods</a><a id="Alternative-Weighting-Methods-1"></a><a class="docs-heading-anchor-permalink" href="#Alternative-Weighting-Methods" title="Permalink"></a></h3><p>Customize projection weighting to emphasize different physical aspects:</p><pre><code class="language-julia hljs"># Volume-weighted projection (alternative to mass-weighted default)
proj_z = projection(gas, :cs, :km_s,
                    weighting=[:volume]);  # Volume weighting instead of mass</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:00:21.776

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]

Selected var(s)=(:cs,)
Weighting      = :volume

Effective resolution: 4096^2
Map size: 4096 x 4096
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (cs)
Processing mode: Sequential (single thread)
</code></pre><pre><code class="nohighlight hljs">Progress: 100%|█████████████████████████████████████████| Time: 0:00:15
</code></pre><h4 id="Custom-Weighting-with-Units"><a class="docs-heading-anchor" href="#Custom-Weighting-with-Units">Custom Weighting with Units</a><a id="Custom-Weighting-with-Units-1"></a><a class="docs-heading-anchor-permalink" href="#Custom-Weighting-with-Units" title="Permalink"></a></h4><p>Use any predefined quantity as weighting with specified units:</p><pre><code class="language-julia hljs"># Volume-weighted with explicit units
proj_z = projection(gas, :cs, :km_s,
                    weighting=[:volume, :cm3]);  # Volume in cm³ units</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:00:53.729

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
zmin::zmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]

Selected var(s)=(:cs,)
Weighting      = :volume

Effective resolution: 4096^2
Map size: 4096 x 4096
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 1 (cs)
Processing mode: Sequential (single thread)
</code></pre><pre><code class="nohighlight hljs">Progress: 100%|█████████████████████████████████████████| Time: 0:00:15
</code></pre><h2 id="Specialized-Applications"><a class="docs-heading-anchor" href="#Specialized-Applications">Specialized Applications</a><a id="Specialized-Applications-1"></a><a class="docs-heading-anchor-permalink" href="#Specialized-Applications" title="Permalink"></a></h2><h3 id="Ultra-Thin-Slice-Analysis"><a class="docs-heading-anchor" href="#Ultra-Thin-Slice-Analysis">Ultra-Thin Slice Analysis</a><a id="Ultra-Thin-Slice-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Ultra-Thin-Slice-Analysis" title="Permalink"></a></h3><p>Create quasi-2D cuts through 3D data using extremely narrow projection ranges:</p><pre><code class="language-julia hljs"># Ultra-thin slice: effectively 2D cut through 3D data
proj_y = projection(gas, [:sd, :v], [:Msol_pc2, :km_s],
                    yrange=[0.0001,0.0001],   # Extremely narrow range (0.1 pc)
                    center=[:bc],
                    range_unit=:kpc,
                    direction=:y)  ;           # Y-direction slice</code></pre><pre><code class="nohighlight hljs">[Mera]: 2025-08-14T15:01:26.335

center: [0.5, 0.5, 0.5] ==&gt; [24.0 [kpc] :: 24.0 [kpc] :: 24.0 [kpc]]

domain:
xmin::xmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]
ymin::ymax: 0.5000021 :: 0.5000021  	==&gt; 24.0 [kpc] :: 24.0 [kpc]
zmin::zmax: 0.0 :: 1.0  	==&gt; 0.0 [kpc] :: 48.0 [kpc]

Selected var(s)=(:sd, :v)
Weighting      = :mass

Effective resolution: 4096^2
Map size: 4096 x 4096
Pixel size: 11.719 [pc]
Simulation min.: 11.719 [pc]

Available threads: 8
Requested max_threads: 8
Variables: 2 (sd, v)
Processing mode: Variable-based parallel (2 threads)
</code></pre><pre><code class="language-julia hljs"># Visualize ultra-thin slice velocity field
figure(figsize=(10, 3.5))
im = imshow(log10.(permutedims(proj_y.maps[:v])),
           cmap=cmap2,
           origin=&quot;lower&quot;,
           extent=proj_y.cextent)
xlabel(&quot;y [kpc]&quot;)
ylabel(&quot;z [kpc]&quot;)
cb = colorbar(im, label=L&quot;\mathrm{log10(v) \ [km \ s^{-1}]}&quot;);

# Note: Ultra-thin slices provide all cells that intersect the 2D plane</code></pre><p><img src="../06_hydro_Projection_files/06_hydro_Projection_95_1.png" alt/></p><pre><code class="nohighlight hljs">Figure(PyObject &lt;Figure size 1000x350 with 2 Axes&gt;)</code></pre><h2 id="Summary"><a class="docs-heading-anchor" href="#Summary">Summary</a><a id="Summary-1"></a><a class="docs-heading-anchor-permalink" href="#Summary" title="Permalink"></a></h2><p>This tutorial covered the comprehensive projection capabilities of MERA.jl for hydrodynamical data analysis. You&#39;ve learned how to:</p><h3 id="Core-Functionality"><a class="docs-heading-anchor" href="#Core-Functionality">Core Functionality</a><a id="Core-Functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Core-Functionality" title="Permalink"></a></h3><ul><li><strong>Create basic projections</strong> with <code>projection(data, :variable, :unit)</code></li><li><strong>Control projection directions</strong> (x, y, z) for different viewing angles</li><li><strong>Select spatial regions</strong> using <code>xrange</code>, <code>yrange</code>, <code>zrange</code> parameters</li><li><strong>Access projection results</strong> through the structured output object</li></ul><h3 id="Advanced-Techniques"><a class="docs-heading-anchor" href="#Advanced-Techniques">Advanced Techniques</a><a id="Advanced-Techniques-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced-Techniques" title="Permalink"></a></h3><ul><li><strong>Multi-quantity projections</strong> for efficient batch processing</li><li><strong>Cylindrical coordinate analysis</strong> for galactic disk studies</li><li><strong>Resolution control</strong> via <code>lmax</code>, <code>res</code>, and <code>pxsize</code> parameters</li><li><strong>Masking and filtering</strong> for targeted physical analysis</li><li><strong>Custom weighting schemes</strong> beyond default mass-weighting</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/masking_filtering/">« API Reference</a><a class="docs-footer-nextpage" href="../06_particles_Projection/">Particles »</a><div class="flexbox-break"></div><p class="footer-message">© 2025 Manuel Behrendt. Built with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and <a href="https://julialang.org">Julia</a>. </p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 9 September 2025 10:00">Tuesday 9 September 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
